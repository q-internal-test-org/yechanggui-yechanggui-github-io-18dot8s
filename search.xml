<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2023/06/29/%E9%87%8F%E5%8C%96/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/"/>
      <url>/2023/06/29/%E9%87%8F%E5%8C%96/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="指标"><a href="#指标" class="headerlink" title="指标"></a>指标</h1><h2 id="收益"><a href="#收益" class="headerlink" title="收益"></a>收益</h2><p>-</p><ul><li>Alpha是投资者获得与市场波动无关的回报</li><li><ul><li>新节点<ul><li>新节点</li></ul></li></ul></li></ul><h2 id="风险"><a href="#风险" class="headerlink" title="风险"></a>风险</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/06/29/kubernetes/%E5%A4%B1%E6%95%88%E5%BD%92%E5%9B%A0%E4%B8%9A%E5%8A%A1BUG/"/>
      <url>/2023/06/29/kubernetes/%E5%A4%B1%E6%95%88%E5%BD%92%E5%9B%A0%E4%B8%9A%E5%8A%A1BUG/</url>
      
        <content type="html"><![CDATA[<h3 id="访问环境"><a href="#访问环境" class="headerlink" title="访问环境"></a>访问环境</h3><p><a href="http://172.26.24.59:32065/">知识图谱</a></p><p><strong>问句</strong> : 开式循环冷却水泵 B 入口压力开关时拒动</p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306282022806.png" alt="image.png"></p><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>   从下面的原始数据来看，==开式循环冷却水泵 B 入口压力==/开关时拒动 这个问句中的开式循环冷却水泵 B 入口压力原始数据中没有开关时拒动这个现象，但是返回了”电机故障”和”控制器、主板、力矩传感器失效” 这两个原因属于==一次风机7A 动叶执行机构==的开关时拒动的原因。<br>   客户期望： 因为==开式循环冷却水泵 B 入口压力== 和 ==开式循环冷却水泵 B 出口电动阀执行机构== 同属于 开式水系统，应该 返回的是开式循环冷却水泵 B 出口电动阀执行机构开关时拒动的原因 (机械故障（机械阻力过大）) 而不是 一次风机系统的别的设备的开关时拒动的原因</p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306282048034.png" alt="image.png"></p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306291229413.png" alt="image.png"></p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306282053138.png" alt="image.png"></p><p>排查：</p><ol><li>失效归因相关配置<br><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306291237148.png" alt="image.png"></li></ol><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306291320900.png" alt="image.png"></p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306291334565.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/06/29/kubernetes/%E6%9C%AA%E5%91%BD%E5%90%8D/"/>
      <url>/2023/06/29/kubernetes/%E6%9C%AA%E5%91%BD%E5%90%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="同层级"><a href="#同层级" class="headerlink" title="同层级"></a>同层级</h2><h3 id="问句示例"><a href="#问句示例" class="headerlink" title="问句示例"></a>问句示例</h3><table><thead><tr><th align="left">设备</th><th align="left">现象</th><th align="left">扩展</th></tr></thead><tbody><tr><td align="left">开式循环冷却水泵 B 入口压力</td><td align="left">接口渗漏</td><td align="left">开式循环冷却水泵 B/开式循环冷却水泵 B/开式循环冷却水泵 B/循环冷却水泵 B 入口/</td></tr><tr><td align="left">开式循环冷却水泵B入口压力</td><td align="left">开关时拒动</td><td align="left">开式循环冷却水泵 B/开式循环冷却水泵 B/开式循环冷却水泵 B/循环冷却水泵 B 入口/</td></tr></tbody></table><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306281943322.png" alt="image.png"></p><h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306281944832.png" alt="image.png"></p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202306282000492.png" alt="image.png"></p><h2 id="同类型"><a href="#同类型" class="headerlink" title="同类型"></a>同类型</h2><h3 id="case-1-现象外三发生过"><a href="#case-1-现象外三发生过" class="headerlink" title="case 1  现象外三发生过"></a>case 1  现象外三发生过</h3>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/06/29/obsdian/demo/"/>
      <url>/2023/06/29/obsdian/demo/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### [](https://github.com/valentine195/obsidian-admonition/blob/master/README.md#color)Color ###</span><br><span class="line"></span><br><span class="line">The admonition color can be overridden using the `color` parameter. **The color entered must be an RGB triad.**</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">color: 200, 200, 200</span><br><span class="line">collapse: True</span><br><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla.</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: 检查</span><br><span class="line">collapse: open</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>grafna</title>
      <link href="/2023/06/22/docker/grafna/"/>
      <url>/2023/06/22/docker/grafna/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;3.2&quot;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  grafana:</span><br><span class="line">    image: portainer/template-swarm-monitoring:grafana-9.5.2</span><br><span class="line">    ports:</span><br><span class="line">      - target: 3000</span><br><span class="line">        published: 3000</span><br><span class="line">        protocol: tcp</span><br><span class="line">        mode: ingress</span><br><span class="line">    deploy:</span><br><span class="line">      replicas: 1</span><br><span class="line">      restart_policy:</span><br><span class="line">        condition: on-failure</span><br><span class="line">      placement:</span><br><span class="line">        constraints:</span><br><span class="line">          - node.role == manager</span><br><span class="line">    volumes:</span><br><span class="line">      - type: volume</span><br><span class="line">        source: grafana-data</span><br><span class="line">        target: /var/lib/grafana</span><br><span class="line">    environment:</span><br><span class="line">      - GF_SECURITY_ADMIN_USER=admin</span><br><span class="line">      - GF_SECURITY_ADMIN_PASSWORD=datagrand@123</span><br><span class="line">      - GF_USERS_ALLOW_SIGN_UP=false</span><br><span class="line">    networks:</span><br><span class="line">      - net    </span><br><span class="line"></span><br><span class="line">  prometheus:</span><br><span class="line">    image: portainer/template-swarm-monitoring:prometheus-v2.44.0</span><br><span class="line">    command:</span><br><span class="line">      - &#x27;--config.file=/etc/prometheus/prometheus.yml&#x27;</span><br><span class="line">      - &#x27;--log.level=error&#x27;</span><br><span class="line">      - &#x27;--storage.tsdb.path=/prometheus&#x27;</span><br><span class="line">      - &#x27;--storage.tsdb.retention.time=7d&#x27;</span><br><span class="line">    ports:</span><br><span class="line">      - target: 9090</span><br><span class="line">        published: 9090</span><br><span class="line">        protocol: tcp</span><br><span class="line">        mode: ingress</span><br><span class="line">    deploy:</span><br><span class="line">      replicas: 1</span><br><span class="line">      restart_policy:</span><br><span class="line">        condition: on-failure</span><br><span class="line">      placement:</span><br><span class="line">        constraints:</span><br><span class="line">          - node.labels.role == database</span><br><span class="line">    volumes:</span><br><span class="line">      - type: volume</span><br><span class="line">        source: prometheus-data</span><br><span class="line">        target: /prometheus</span><br><span class="line">    networks:</span><br><span class="line">      - net</span><br><span class="line"></span><br><span class="line">  cadvisor:</span><br><span class="line">    image: registry.cn-beijing.aliyuncs.com/luohuiwen20/cadvisor:v0.47.0</span><br><span class="line">    command: -logtostderr -docker_only</span><br><span class="line">    deploy:</span><br><span class="line">      mode: global</span><br><span class="line">      resources:</span><br><span class="line">        limits:</span><br><span class="line">          memory: 128M</span><br><span class="line">        reservations:</span><br><span class="line">          memory: 64M</span><br><span class="line">    volumes:</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /</span><br><span class="line">        target: /rootfs</span><br><span class="line">        read_only: true</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /var/run</span><br><span class="line">        target: /var/run</span><br><span class="line">        read_only: true</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /sys</span><br><span class="line">        target: /sys</span><br><span class="line">        read_only: true</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /var/lib/docker</span><br><span class="line">        target: /var/lib/docker</span><br><span class="line">        read_only: true</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /dev/disk</span><br><span class="line">        target: /dev/disk</span><br><span class="line">        read_only: true                        </span><br><span class="line">    networks:</span><br><span class="line">      - net</span><br><span class="line"></span><br><span class="line">  node-exporter:</span><br><span class="line">    image: prom/node-exporter:v1.5.0</span><br><span class="line">    command:</span><br><span class="line">      - &#x27;--path.sysfs=/host/sys&#x27;</span><br><span class="line">      - &#x27;--path.procfs=/host/proc&#x27;</span><br><span class="line">      - &#x27;--collector.filesystem.ignored-mount-points=^/(sys|proc|dev|host|etc)($$|/)&#x27;</span><br><span class="line">      - &#x27;--no-collector.ipvs&#x27;</span><br><span class="line">    deploy:</span><br><span class="line">      mode: global</span><br><span class="line">      resources:</span><br><span class="line">        limits:</span><br><span class="line">          memory: 128M</span><br><span class="line">        reservations:</span><br><span class="line">          memory: 64M</span><br><span class="line">    volumes:</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /</span><br><span class="line">        target: /rootfs</span><br><span class="line">        read_only: true</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /proc</span><br><span class="line">        target: /host/proc</span><br><span class="line">        read_only: true</span><br><span class="line">      - type: bind</span><br><span class="line">        source: /sys</span><br><span class="line">        target: /host/sys</span><br><span class="line">        read_only: true</span><br><span class="line">    networks:</span><br><span class="line">      - net</span><br><span class="line"></span><br><span class="line">volumes:</span><br><span class="line">  grafana-data:</span><br><span class="line">  prometheus-data:</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  net:</span><br><span class="line">    driver: overlay</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux 网络配置</title>
      <link href="/2023/06/03/linux/linux%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"/>
      <url>/2023/06/03/linux/linux%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="网络配置图形界面"><a href="#网络配置图形界面" class="headerlink" title="网络配置图形界面"></a>网络配置图形界面</h2><p>`</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmtui</span><br></pre></td></tr></table></figure><h2 id="查看所有网卡"><a href="#查看所有网卡" class="headerlink" title="查看所有网卡"></a>查看所有网卡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr show</span><br></pre></td></tr></table></figure><h2 id="关闭-开启网卡"><a href="#关闭-开启网卡" class="headerlink" title="关闭/开启网卡"></a>关闭/开启网卡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip link set * up/down</span><br></pre></td></tr></table></figure><h2 id="linux-centos-配置无线网卡"><a href="#linux-centos-配置无线网卡" class="headerlink" title="linux centos 配置无线网卡"></a>linux centos 配置无线网卡</h2><h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法 1"></a>方法 1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ip link set wlp0s20u2 up # 启用无线卡</span><br><span class="line">wpa_supplicant -B -i wlp0s20u2 -c &lt;(wpa_passphrase &quot;wgq3_b5&quot; &quot;wgq3b5wifi&quot;) #连接无线网</span><br><span class="line"></span><br><span class="line">dhclient wlp0s20u2  #分配IP地址，通过dhclient控制网卡进行网络操作获取IP</span><br></pre></td></tr></table></figure><h4 id="方法-2"><a href="#方法-2" class="headerlink" title="方法 2"></a>方法 2</h4><ol><li><p>安装 i w <a href="https://developer.aliyun.com/mirror/">Fetching Title#vf8d</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iw-4.3-2.el7.x86_64.rpm</span><br><span class="line">libnl-1.1.4-3.el7.x86_64.rpm</span><br></pre></td></tr></table></figure></li><li><p>无线网卡 相关操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iw list #查看网卡</span><br><span class="line">iw dev #查看网口</span><br><span class="line">iw wls1 link #查看网口网络连接 </span><br><span class="line">iw wls1 scan | grep SSID</span><br></pre></td></tr></table></figure></li><li><p>连接 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考方法1</span><br></pre></td></tr></table></figure></li></ol><h2 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install NetworkManager-wifi</span><br></pre></td></tr></table></figure><p><a href="https://zhuanlan.zhihu.com/p/35143635">centos连接wifi无线网 - 知乎</a></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://zhuanlan.zhihu.com/p/35143635">centos连接wifi无线网 - 知乎</a></p><p><a href="https://juejin.cn/post/7159951033853018120">CentOS离线安装RPM及其依赖包 - 掘金</a></p><p><a href="https://www.cnblogs.com/tkid/p/3998721.html">Linux无线工具详解(Wireless tools for Linux) - tkid - 博客园</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu相关操作</title>
      <link href="/2023/05/08/linux/ubuntu%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/"/>
      <url>/2023/05/08/linux/ubuntu%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="离线包制作"><a href="#离线包制作" class="headerlink" title="离线包制作"></a>离线包制作</h2><ol><li><p>.查看依赖</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apt-cache depends XXX</span><br></pre></td></tr></table></figure></li><li><p>下载 deb 及其依赖包</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">apt-get download $(apt-cache depends --recurse --no-recommends --no-suggests --no-conflicts --no-breaks --no-replaces --no-enhances --no-pre-depends XXX | grep -v i386 | grep &quot;^\w&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="3"><li>使用 dpkg 命令离线安装</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i *.deb</span><br></pre></td></tr></table></figure><h3 id="离线-vscode"><a href="#离线-vscode" class="headerlink" title="离线 vscode"></a>离线 vscode</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">commit_id=704ed70d4fd1c6bd6342c436f1ede30d1cff4710</span><br><span class="line">PATH_TO_YOUR_VSCODE_SERVER=/home/ycg</span><br><span class="line"></span><br><span class="line">mkdir -p ~/.vscode-server/bin/$&#123;commit_id&#125;</span><br><span class="line">cp $&#123;PATH_TO_YOUR_VSCODE_SERVER&#125;/vscode-server-linux-x64.tar.gz ~/.vscode-server/bin/$&#123;commit_id&#125;</span><br><span class="line"></span><br><span class="line">cd ~/.vscode-server/bin/$&#123;commit_id&#125;</span><br><span class="line">tar -xzf vscode-server-linux-x64.tar.gz &amp;&amp; rm vscode-server-linux-x64.tar.gz</span><br><span class="line">mv vscode-server-linux-x64/* . &amp;&amp; rm -r vscode-server-linux-x64</span><br><span class="line"></span><br><span class="line">mkdir -p ~/.vscode-server/extensions</span><br><span class="line">cp -r $&#123;PATH_TO_YOUR_VSCODE_EXTENSIONS&#125;/extensions/* ~/.vscode-server/extensions</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文心一言vsChatgpt</title>
      <link href="/2023/04/30/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E6%96%87%E5%BF%83%E4%B8%80%E8%A8%80vsChatgpt/"/>
      <url>/2023/04/30/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E6%96%87%E5%BF%83%E4%B8%80%E8%A8%80vsChatgpt/</url>
      
        <content type="html"><![CDATA[<p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202304301703338.png" alt="image.png"></p><p><img src="https://gitee.com/vincent_YE/markdown-images/raw/master/images/202304301703175.png" alt="image.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 人工智能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>注意力机制</title>
      <link href="/2023/03/30/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/"/>
      <url>/2023/03/30/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> 注意力机制 </tag>
            
            <tag> 特征筛选 </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 位置关系 </tag>
            
            <tag> 权重参数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>quant-101</title>
      <link href="/2022/11/03/%E9%87%8F%E5%8C%96/quant-101/"/>
      <url>/2022/11/03/%E9%87%8F%E5%8C%96/quant-101/</url>
      
        <content type="html"><![CDATA[<h1 id="指标"><a href="#指标" class="headerlink" title="指标"></a>指标</h1><h2 id="Alpha"><a href="#Alpha" class="headerlink" title="Alpha"></a>Alpha</h2><pre><code>Alpha是投资者获得与市场波动无关的回报。比如投资者获得了15%的回报，其基准获得了10%的回报，那么Alpha或者价值增值的部分就是5%。</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> 量化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hardhat使用</title>
      <link href="/2022/09/04/WEB3/Hardhat/hardhat%E4%BD%BF%E7%94%A8/"/>
      <url>/2022/09/04/WEB3/Hardhat/hardhat%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> WEB3 </tag>
            
            <tag> Hardhat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>solidity</title>
      <link href="/2022/07/09/WEB3/solidity/solidity/"/>
      <url>/2022/07/09/WEB3/solidity/solidity/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> WEB3 </tag>
            
            <tag> solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>私有链安装</title>
      <link href="/2022/07/07/WEB3/%E7%A7%81%E6%9C%89%E9%93%BE%E5%AE%89%E8%A3%85/"/>
      <url>/2022/07/07/WEB3/%E7%A7%81%E6%9C%89%E9%93%BE%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h3 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sh scripts/build_image.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="服务启动"><a href="#服务启动" class="headerlink" title="服务启动"></a>服务启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">docker rm -f $(docker ps -qa -f name=eth)</span><br><span class="line"></span><br><span class="line">docker run -it --name eth -v /data/adpt/docker-app/ethereum/scripts/boot_start.sh:/root/boot_start.sh ccr.ccs.tencentyun.com/vincent/ethereum:20220705222003</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="创世区块配置"><a href="#创世区块配置" class="headerlink" title="创世区块配置"></a>创世区块配置</h3><p> ![[Pasted image 20220707153401.png]]</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ol><li><p><a href="https://medium.com/scb-digital/running-a-private-ethereum-blockchain-using-docker-589c8e6a4fe8">https://medium.com/scb-digital/running-a-private-ethereum-blockchain-using-docker-589c8e6a4fe8</a></p></li><li><p><a href="https://github.com/HuaRongSAO/ethereum-testnet-docker">https://github.com/HuaRongSAO/ethereum-testnet-docker</a></p></li><li><p><a href="https://github.com/Capgemini-AIE/ethereum-docker">https://github.com/Capgemini-AIE/ethereum-docker</a></p></li><li><p><a href="https://www.cnblogs.com/wanghui-garcia/p/10256520.html">https://www.cnblogs.com/wanghui-garcia/p/10256520.html</a></p></li><li><p><a href="https://www.cnblogs.com/wkfvawl/p/11211600.html">https://www.cnblogs.com/wkfvawl/p/11211600.html</a></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> WEB3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Geth</title>
      <link href="/2022/07/07/WEB3/Geth/"/>
      <url>/2022/07/07/WEB3/Geth/</url>
      
        <content type="html"><![CDATA[<h3 id="进入console"><a href="#进入console" class="headerlink" title="进入console"></a>进入console</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it ethereum_geth-rpc-endpoint_1 geth attach --datadir=&#x27;/root/blockchain_data&#x27;</span><br></pre></td></tr></table></figure><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>这是一个交互式的Javascript执行环境，在这里面可以执行Javascript代码，其中&gt;是命令提示符。在这个环境里也内置了一些用来操作以太坊的Javascript对象，可以直接使用这些对象。这些对象主要包括：</p><ul><li>  eth：包含一些跟操作区块链相关的方法</li><li>  net：包含以下查看p2p网络状态的方法</li><li>  admin：包含一些与管理节点相关的方法</li><li>  miner：包含启动&amp;停止挖矿的一些方法</li><li>  personal：主要包含一些管理账户的方法</li><li>  txpool：包含一些查看交易内存池的方法</li><li>  web3：包含了以上对象，还包含一些单位换算的方法</li></ul><p>其中常用命令有：</p><ul><li>  personal.newAccount(‘133’)：创建账户；</li><li>  personal.unlockAccount(“0x0c00bd425d74357abc10b69599bb4ce7b203bbe7”, “tiatnain123”)：解锁账户；</li><li>  eth.accounts：枚举系统中的账户；</li><li>  eth.getBalance(“0xbce4f7e52556a32e0b44123749ef8baea65af5b3”)：查看账户余额，返回值的单位是 Wei（Wei - 是以太坊中最小货币面额单位，类似比特币中的聪，1 ether = 10^18 Wei）；</li><li>  eth.blockNumber：列出区块总数；</li><li>  eth.getTransaction()：获取交易；</li><li>  eth.getBlock()：获取区块；</li><li>  miner.start()：开始挖矿；</li><li>  miner.stop()：停止挖矿；</li><li>  web3.fromWei()：Wei 换算成以太币；</li><li>  web3.toWei()：以太币换算成 Wei；</li><li>  txpool.status：交易池中的状态；</li><li>  admin.addPeer()：连接到其他节点；</li></ul><h3 id="交易相关"><a href="#交易相关" class="headerlink" title="交易相关"></a>交易相关</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 账户解锁</span><br><span class="line">personal.unlockAccount(eth.accounts[0],&#x27;tiatnain123&#x27;, 1230000)</span><br><span class="line">personal.unlockAccount(eth.accounts[0],&#x27;133&#x27;, 1230000)</span><br><span class="line"># 获取账户余额</span><br><span class="line">web3.fromWei(eth.getBalance(eth.accounts[0]),&#x27;ether&#x27;)</span><br><span class="line">web3.fromWei(eth.getBalance(eth.accounts[1]),&#x27;ether&#x27;)</span><br><span class="line"></span><br><span class="line">## 发送交易</span><br><span class="line">amount = web3.toWei(5,&#x27;ether&#x27;)</span><br><span class="line">eth.sendTransaction(&#123;from:eth.accounts[0],to:&quot;0x57e60fafa998fab5ff85ef730e2f83c0a9d64ccc&quot;,value:amount&#125;)</span><br><span class="line">eth.sendTransaction(&#123;from:eth.accounts[0],to:&quot;0xfcf14de24a765787f1e8973e5387ac6869cb0c9a&quot;,value:amount&#125;)</span><br><span class="line"></span><br><span class="line">### 交易回调方式</span><br><span class="line">amount = web3.toWei(100,&#x27;ether&#x27;)</span><br><span class="line">eth.sendTransaction(&#123;from:eth.accounts[0],to:&quot;0x229f6d666b69e157b7f5f86c348276cc35f5b8ea&quot;,value:amount&#125;, function(err, transactionHash) &#123;</span><br><span class="line">  if (!err)</span><br><span class="line">    console.log(transactionHash); </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">### 获取交易信息</span><br><span class="line"></span><br><span class="line">eth.getTransaction(&quot;0x210ead7e297300ccfc5658d1798ec04050dc8a96333b2c769d062af3156531f6&quot;)</span><br><span class="line">eth.getTransaction(&quot;0x332c0627d917a68cfb03e66c432c98443bfbabc2c3cc263fdf1e27d55842fa73&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="获取交易信息"><a href="#获取交易信息" class="headerlink" title="获取交易信息"></a>获取交易信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 获取区块个数</span><br><span class="line">eth.blockNumber </span><br><span class="line"></span><br><span class="line"># 获取区块信息</span><br><span class="line"></span><br><span class="line">eth.getBlock(180)</span><br><span class="line">eth.getBlock(&#x27;0x54340760e78a769cff2e4abce3a27df5f1e7f95b87f7d026b3901b61759deb2c&#x27;)</span><br><span class="line"></span><br><span class="line"># 获取交易数量</span><br><span class="line">eth.getTransactionCount(eth.accounts[0])</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> WEB3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫</title>
      <link href="/2022/05/02/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E7%88%AC%E8%99%AB/"/>
      <url>/2022/05/02/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<h3 id="浏览器爬虫"><a href="#浏览器爬虫" class="headerlink" title="浏览器爬虫"></a>浏览器爬虫</h3><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><ol><li><p>webscraper</p><p> 教程: <a href="https://www.bilibili.com/video/BV1LJ411t7Gi?spm_id_from=333.999.0.0">Web Scraper 使用教程（一） 安装_哔哩哔哩_bilibili</a></p></li></ol><h3 id="APP-爬虫"><a href="#APP-爬虫" class="headerlink" title="APP 爬虫"></a>APP 爬虫</h3><h3 id="工具-1"><a href="#工具-1" class="headerlink" title="工具"></a>工具</h3><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker-swarm-nfs</title>
      <link href="/2022/04/30/docker/docker-swarm-nfs/"/>
      <url>/2022/04/30/docker/docker-swarm-nfs/</url>
      
        <content type="html"><![CDATA[<h3 id="创建-nfs-volume"><a href="#创建-nfs-volume" class="headerlink" title="创建 nfs volume"></a>创建 nfs volume</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume create --driver local --opt type=nfs --opt o=addr=42.192.125.62,rw --opt device=:/data/nfs_data volume-nfs</span><br></pre></td></tr></table></figure><h3 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -dit --name busybox7 -v volume-nfs:/nfs busybox</span><br><span class="line"></span><br><span class="line">docker exec busybox7 touch /nfs/testfiles.txt</span><br></pre></td></tr></table></figure><h3 id="docker-compose-修改"><a href="#docker-compose-修改" class="headerlink" title="docker-compose 修改"></a>docker-compose 修改</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">busy:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:latest</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">volume</span></span><br><span class="line">        <span class="attr">source:</span> <span class="string">busybox</span></span><br><span class="line">        <span class="attr">target:</span> <span class="string">/nfs</span></span><br><span class="line">        <span class="attr">volume:</span></span><br><span class="line">          <span class="attr">nocopy:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">busybox:</span></span><br><span class="line">    <span class="attr">driver_opts:</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">&quot;nfs&quot;</span></span><br><span class="line">      <span class="attr">o:</span> <span class="string">&quot;addr=42.192.125.62,nolock,soft,rw&quot;</span></span><br><span class="line">      <span class="attr">device:</span> <span class="string">&quot;:/data/nfs_data/busybox&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>async_mysql</title>
      <link href="/2022/03/12/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/async_mysql/"/>
      <url>/2022/03/12/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/async_mysql/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> DateTime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> ForeignKey</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> func</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Integer</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column, String, INTEGER, BOOLEAN, DATETIME, INTEGER, Column, true, Float, text, Boolean</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.asyncio <span class="keyword">import</span> AsyncSession</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.asyncio <span class="keyword">import</span> create_async_engine</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.future <span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> declarative_base</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> relationship</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> selectinload</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">Base = declarative_base()</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuildTask</span>(<span class="params">Base</span>):</span></span><br><span class="line"></span><br><span class="line">__tablename__ = <span class="string">&#x27;build_task&#x27;</span></span><br><span class="line"></span><br><span class="line">__table_args__ = &#123;<span class="string">&#x27;comment&#x27;</span>: <span class="string">&#x27;构建任务&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">id</span> = Column(INTEGER, primary_key=<span class="literal">True</span>, autoincrement=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">active = Column(BOOLEAN, server_default=true(), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">create_time = Column(DATETIME, default=datetime.now, comment=<span class="string">&quot;修改时间&quot;</span>)</span><br><span class="line"></span><br><span class="line">last_update_time = Column(DATETIME, default=datetime.now, onupdate=datetime.now, comment=<span class="string">&quot;最近修改时间&quot;</span>, index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">name = Column(String(<span class="number">45</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">status = Column(String(<span class="number">10</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>), server_default=text(<span class="string">&quot;&#x27;INIT&#x27;&quot;</span>))</span><br><span class="line"></span><br><span class="line">progress = Column(Float(asdecimal=<span class="literal">True</span>), server_default=text(<span class="string">&quot;&#x27;0&#x27;&quot;</span>))</span><br><span class="line"></span><br><span class="line">flow_group_id = Column(String(<span class="number">100</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">desc = Column(String(<span class="number">255</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">task_id = Column(String(<span class="number">100</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>), nullable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">task_type = Column(String(<span class="number">1</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>), comment=<span class="string">&#x27;构建任务的类型,0:三元组导入 1:标注导入 2:映射式构建导入&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params">Base</span>):</span></span><br><span class="line"></span><br><span class="line">__tablename__ = <span class="string">&quot;a&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="built_in">id</span> = Column(Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">data = Column(String(<span class="number">100</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">create_date = Column(DateTime, server_default=func.now())</span><br><span class="line"></span><br><span class="line">bs = relationship(<span class="string">&quot;B&quot;</span>)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># required in order to access columns with server defaults</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or SQL expression defaults, subsequent to a flush, without</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># triggering an expired load</span></span><br><span class="line"></span><br><span class="line">__mapper_args__ = &#123;<span class="string">&quot;eager_defaults&quot;</span>: <span class="literal">True</span>&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">Base</span>):</span></span><br><span class="line"></span><br><span class="line">__tablename__ = <span class="string">&quot;b&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">id</span> = Column(Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">a_id = Column(ForeignKey(<span class="string">&quot;a.id&quot;</span>))</span><br><span class="line"></span><br><span class="line">data = Column(String(<span class="number">100</span>, <span class="string">&#x27;utf8mb4_bin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># async def async_main():</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># engine = create_async_engine(</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &quot;mysql+aiomysql://root:root@127.0.0.1:3308/kg_db&quot;,</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># async with engine.begin() as conn:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # await conn.run_sync(Base.metadata.drop_all)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># await conn.run_sync(Base.metadata.create_all)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># # expire_on_commit=False will prevent attributes from being expired</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # after commit.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># async_session = sessionmaker(</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># engine, expire_on_commit=False, class_=AsyncSession</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># async with async_session() as session:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># async with session.begin():</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># session.add_all(</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A(bs=[B(), B()], data=&quot;a1&quot;),</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A(bs=[B()], data=&quot;a2&quot;),</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A(bs=[B(), B()], data=&quot;a3&quot;),</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># stmt = select(A).options(selectinload(A.bs))</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># result = await session.execute(stmt)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># for a1 in result.scalars():</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(a1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(f&quot;created at: &#123;a1.create_date&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for b1 in a1.bs:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(b1)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># result = await session.execute(select(A).order_by(A.id))</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># a1 = result.scalars().first()</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># a1.data = &quot;new data&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># await session.commit()</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># # access attribute subsequent to commit; this is what</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # expire_on_commit=False allows</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(a1.data)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># # for AsyncEngine created in function scope, close and</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # clean-up pooled connections</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># await engine.dispose()</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch_and_update_objects</span>(<span class="params">session</span>):</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;run traditional sync-style ORM code in a function that will be</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">invoked within an awaitable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># the session object here is a traditional ORM Session.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># all features are available here including legacy Query use.</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># stmt = select(A)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># result = session.execute(stmt)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for a1 in result.scalars():</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(a1)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># # lazy loads</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for b1 in a1.bs:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(b1)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># legacy Query use</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a1 = session.query(BuildTask).order_by(BuildTask.id).first()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a1 = session.query(BuildTask).order_by(BuildTask.id).first()</span></span><br><span class="line"></span><br><span class="line">a1 = BuildTask.query.<span class="built_in">filter</span>(</span><br><span class="line"></span><br><span class="line">BuildTask.which_graph == <span class="string">&#x27;origingraph&#x27;</span>).first()</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">a1.desc = <span class="string">&quot;new data&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">async_main</span>():</span></span><br><span class="line"></span><br><span class="line">engine = create_async_engine(</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;mysql+aiomysql://root:root@127.0.0.1:3308/kg_db&quot;</span></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># async with engine.begin() as conn:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># await conn.run_sync(Base.metadata.drop_all)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># await conn.run_sync(Base.metadata.create_all)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">with</span> AsyncSession(engine) <span class="keyword">as</span> session:</span><br><span class="line"></span><br><span class="line"><span class="comment"># async with session.begin():</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># session.add_all(</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A(bs=[B(), B()], data=&quot;a1&quot;),</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A(bs=[B()], data=&quot;a2&quot;),</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A(bs=[B(), B()], data=&quot;a3&quot;),</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> session.run_sync(fetch_and_update_objects)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> session.commit()</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># for AsyncEngine created in function scope, close and</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clean-up pooled connections</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> engine.dispose()</span><br><span class="line"></span><br><span class="line">asyncio.run(async_main())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.cnblogs.com/ygy1997/p/11759490.html">aiomysql+sqlalchemy实现ORM框架【实现仿优酷系统添加用户】 - 杨归元 - 博客园</a></p><p><a href="https://cloud.tencent.com/developer/article/1625730">aiomysql异步操作mysql - 云+社区 - 腾讯云</a></p><p><a href="https://aiomysql.readthedocs.io/en/latest/sa.html#engine">Asynchronous I/O (asyncio) — SQLAlchemy 1.4 Documentation</a></p><p><a href="https://docs.sqlalchemy.org/en/14/orm/extensions/asyncio.html#preventing-implicit-io-when-using-asyncsession">Asynchronous I/O (asyncio) — SQLAlchemy 1.4 Documentation</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dataclass</title>
      <link href="/2022/02/25/python/dataclass/"/>
      <url>/2022/02/25/python/dataclass/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">    一个使用内置的数据类表示数据的 demo</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import json</span><br><span class="line">from dataclasses import (</span><br><span class="line">    asdict, dataclass, field, fields, is_dataclass</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 对于一些嵌套的数据类，需要深度遍历</span><br><span class="line">class EnhancedJSONEncoder(json.JSONEncoder):</span><br><span class="line">    def default(self, o):</span><br><span class="line">        if is_dataclass(o):</span><br><span class="line">            return asdict(o)</span><br><span class="line">        return super().default(o)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def dicts_to_dataclasses(instance):</span><br><span class="line">    &quot;&quot;&quot;将所有的数据类属性都转化到数据类中&quot;&quot;&quot;</span><br><span class="line">    cls = type(instance)</span><br><span class="line">    for f in fields(cls):</span><br><span class="line">        if not is_dataclass(f.type):</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">        value = getattr(instance, f.name)</span><br><span class="line">        if not isinstance(value, dict):</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">        new_value = f.type(**value)</span><br><span class="line">        setattr(instance, f.name, new_value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@dataclass</span><br><span class="line">class Base:</span><br><span class="line">    def __post_init__(self):</span><br><span class="line">        dicts_to_dataclasses(self)</span><br><span class="line"></span><br><span class="line">    def as_dict(self):</span><br><span class="line">        return asdict(self)</span><br><span class="line"></span><br><span class="line">    def as_json(self):</span><br><span class="line">        return json.dumps(self, cls=EnhancedJSONEncoder)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@dataclass</span><br><span class="line">class Cover(Base):</span><br><span class="line">    id: str = None</span><br><span class="line">    cover_id: str = None</span><br><span class="line">    offset_x: str = field(default=None, repr=False)</span><br><span class="line">    offset_y: str = field(default=None, repr=False)</span><br><span class="line">    source: str = field(default=None, repr=False)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@dataclass</span><br><span class="line">class Page(Base):</span><br><span class="line">    id: str = None</span><br><span class="line">    about: str = field(default=&#x27;&#x27;, repr=False)</span><br><span class="line">    birthday: str = field(default=None, repr=False)</span><br><span class="line">    name: str = None</span><br><span class="line">    username: str = None</span><br><span class="line">    fan_count: int = field(default=None, repr=False)</span><br><span class="line">    cover: Cover = field(default=None, repr=False)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    data = &#123;</span><br><span class="line">        &quot;id&quot;: &quot;20531316728&quot;,</span><br><span class="line">        &quot;about&quot;: &quot;The Facebook Page celebrates how our friends inspire us, support us, and help us discover the world when we connect.&quot;,</span><br><span class="line">        &quot;birthday&quot;: &quot;02/04/2004&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Facebook&quot;,</span><br><span class="line">        &quot;username&quot;: &quot;facebookapp&quot;,</span><br><span class="line">        &quot;fan_count&quot;: 214643503,</span><br><span class="line">        &quot;cover&quot;: &#123;</span><br><span class="line">            &quot;cover_id&quot;: &quot;10158913960541729&quot;,</span><br><span class="line">            &quot;offset_x&quot;: 50,</span><br><span class="line">            &quot;offset_y&quot;: 50,</span><br><span class="line">            &quot;source&quot;: &quot;https://scontent.xx.fbcdn.net/v/t1.0-9/s720x720/73087560_10158913960546729_8876113648821469184_o.jpg?_nc_cat=1&amp;_nc_ohc=bAJ1yh0abN4AQkSOGhMpytya2quC_uS0j0BF-XEVlRlgwTfzkL_F0fojQ&amp;_nc_ht=scontent.xx&amp;oh=2964a1a64b6b474e64b06bdb568684da&amp;oe=5E454425&quot;,</span><br><span class="line">            &quot;id&quot;: &quot;10158913960541729&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    # 数据加载</span><br><span class="line">    p = Page(**data)</span><br><span class="line"></span><br><span class="line">    print(p.name)</span><br><span class="line">    print(p)</span><br><span class="line">    print(p.cover)</span><br><span class="line"></span><br><span class="line">    print(p.as_dict())</span><br><span class="line">    print(p.as_json())</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.jianshu.com/p/470aea3df22b">Python 数据类 dataclasses 实践 - 简书</a><br><a href="https://github.com/MerleLiuKun/my-python/blob/master/sundries/dataclass/demo3.py">https://github.com/MerleLiuKun/my-python/blob/master/sundries/dataclass/demo3.py</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rasa</title>
      <link href="/2022/01/18/Bot/rasa/"/>
      <url>/2022/01/18/Bot/rasa/</url>
      
        <content type="html"><![CDATA[<h2 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rasa init </span><br></pre></td></tr></table></figure><h2 id="训练模型"><a href="#训练模型" class="headerlink" title="训练模型"></a>训练模型</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="运行服务"><a href="#运行服务" class="headerlink" title="运行服务"></a>运行服务</h2><ol><li>只运行 action </li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Rasa-官方文档"><a href="#Rasa-官方文档" class="headerlink" title="Rasa 官方文档"></a>Rasa 官方文档</h2><p><a href="https://rasa.com/docs/rasa/pages/http-api#tag/Server-Information">Rasa Open Source Documentation</a></p><p><a href="https://www.rasachatbot.com/">Rasa 聊天机器人中文官方文档|磐创AI</a></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://blog.csdn.net/andrexpert/article/details/104328946">Rasa中文聊天机器人开发指南(1)：入门篇_蒋东国的博客-CSDN博客_rasa调试</a></p><p><a href="https://terrifyzhao.github.io/2018/09/17/Rasa%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%9701.html">Rasa使用指南01 - Welcome to AI World</a></p><h2 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h2><p><a href="https://blog.csdn.net/Kangyucheng/article/details/82822202">python开源聊天机器人ChatterBot——聊天机器人搭建、流程分析、源码分析_康雨城-CSDN博客_python 中文聊天机器人</a><br><a href="https://www.jianshu.com/p/bd1bb573511c">多轮对话 - Core篇 - 简书</a><br><a href="https://zhuanlan.zhihu.com/p/32716205">多轮对话之对话管理(Dialog Management) - 知乎</a><br><a href="https://www.52nlp.cn/rasa%E5%85%A5%E5%9D%91%E6%8C%87%E5%8D%97-%E5%88%9D%E8%AF%86rasa">Rasa 入坑指南一：初识 Rasa – 我爱自然语言处理</a></p><p><a href="https://www.jianshu.com/p/ad11f5815447">Rasa 聊天机器人框架使用 - 简书</a></p><h2 id="专栏"><a href="#专栏" class="headerlink" title="专栏"></a>专栏</h2><p><a href="https://www.zhihu.com/column/c_1318281710002663424">RASA框架应用 - 知乎</a><br><a href="https://cloud.tencent.com/developer/article/1558125">Rasa 聊天机器人专栏（五）：模型评估 - 云+社区 - 腾讯云</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzAxMTU5Njg4NQ==&mid=2247489834&idx=1&sn=941e052b379b3c9b348d63dd0ffdd32f&chksm=9bbffc10acc875064abf127e05a135d67633bbcb9193db303704817d12776190dcb7fccfcee9&scene=178&cur_album_id=2032260139549851649#rd">基于RASA开始中文机器人实现机制</a></p><h2 id="示例仓库"><a href="#示例仓库" class="headerlink" title="示例仓库"></a>示例仓库</h2><p><a href="http://www.crownpku.com/2017/07/27/%E7%94%A8Rasa_NLU%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AD%E6%96%87NLU%E7%B3%BB%E7%BB%9F.html">用Rasa NLU构建自己的中文NLU系统</a></p><p><a href="https://blog.csdn.net/m0_49501453/article/details/120113135?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&utm_relevant_index=2">RASA2.0 搭建中文聊天机器人（附gitee源码）_m0_49501453的博客-CSDN博客_rasa中文聊天机器人</a></p><p><a href="https://gitcode.net/mirrors/jiangdongguo/chitchatassistant?utm_source=csdn_github_accelerator">mirrors / jiangdongguo / chitchatassistant · GitCode</a></p><p><a href="https://github.com/paschmann/rasa-ui">https://github.com/paschmann/rasa-ui</a></p><p><a href="https://github.com/crownpku/awesome-chinese-nlp#qa--chatbot-%E9%97%AE%E7%AD%94%E5%92%8C%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-1">https://github.com/crownpku/awesome-chinese-nlp#qa–chatbot-问答和聊天机器人-1</a></p><p><a href="https://github.com/paschmann/rasa-ui">https://github.com/paschmann/rasa-ui</a></p><p><a href="https://github.com/crownpku/Rasa_NLU_Chi">https://github.com/crownpku/Rasa_NLU_Chi</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Bot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s101</title>
      <link href="/2022/01/09/kubernetes/k8s101/"/>
      <url>/2022/01/09/kubernetes/k8s101/</url>
      
        <content type="html"><![CDATA[<h2 id="1-Docker-Swarm-与Kubernetes对比"><a href="#1-Docker-Swarm-与Kubernetes对比" class="headerlink" title="1. Docker Swarm 与Kubernetes对比"></a>1. Docker Swarm 与Kubernetes对比</h2><p><img src="https://i.imgur.com/e2gNveq.png"></p><h2 id="2-Kubernetes"><a href="#2-Kubernetes" class="headerlink" title="2. Kubernetes"></a>2. Kubernetes</h2><h3 id="2-1-组件"><a href="#2-1-组件" class="headerlink" title="2.1 组件"></a>2.1 组件</h3><p><img src="https://i.imgur.com/Yf06kGV.png"></p><p><strong>Control Plane</strong></p><ul><li><p>kube-apiserver <a href="https://kubernetes.io/docs/concepts/overview/components/#kube-apiserver"></a></p><ul><li>管理所有的 k8s API </li></ul></li><li><p>etcd</p><ul><li>k8s 所有的 运行数据都在这里</li><li>对性能要求比较高</li></ul></li><li><p>kube-scheduler <a href="https://kubernetes.io/docs/concepts/overview/components/#kube-scheduler"></a></p><ul><li> 负责调度pod 到node 上运行</li></ul></li><li><p>kube-controller-manager</p><ul><li>Nodecontroller:检查/更新Node的运行状态</li><li>Jobcontroller:为Job对象创建Pod</li><li>Endpointscontroller:更新Endpoints对象的状态</li><li>ServiceAccount和Tokencontroller:为新建namespace创建默认账号和APl访问token</li></ul></li></ul><p><strong>Node节点组件</strong></p><ul><li>节点<ul><li>·Master节点:只运行控制平面组件的服务器</li><li>Worker节点:只运行节点组件和应用的服务器</li></ul></li><li>kubelet<ul><li>负责确保Pod健康运行</li></ul></li><li>kube-proxy·<ul><li>实现了Service概念中的VIP部分</li></ul></li><li>容器运行时<ul><li>一般是docker,负责创建、运行销毁容器</li></ul></li></ul><p><a href="https://kubernetes.io/docs/concepts/workloads/pods/"><strong>POD 概念</strong></a></p><ul><li>Pod是K8S的最小部署单元</li><li>由一个或多个容器组成</li><li>受限的资源:CPU和内存容器间</li><li>pod下的containers共享storage<ul><li>通过共享卷的方式</li></ul></li><li>容器间network<ul><li>同一个IP的不同端口</li></ul></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-deployment</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">nginx:1.14.2</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Pod 和控制器</strong></p><p>你可以使用工作负载资源来创建和管理多个 Pod。 资源的控制器能够处理副本的管理、上线，并在 Pod 失效时提供自愈能力。 例如，如果一个节点失败，控制器注意到该节点上的 Pod 已经停止工作， 就可以创建替换性的 Pod。调度器会将替身 Pod 调度到一个健康的节点执行。</p><p>下面是一些管理一个或者多个 Pod 的工作负载资源的示例：</p><ul><li>  <a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">Deployment</a></li><li>  <a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/statefulset/">StatefulSet</a></li><li>  <a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">Deployments | Kubernetes</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s用helm 部署gitlab</title>
      <link href="/2022/01/05/kubernetes/k8s%E7%94%A8helm%20%E9%83%A8%E7%BD%B2gitlab/"/>
      <url>/2022/01/05/kubernetes/k8s%E7%94%A8helm%20%E9%83%A8%E7%BD%B2gitlab/</url>
      
        <content type="html"><![CDATA[<h2 id="下载-helm-包"><a href="#下载-helm-包" class="headerlink" title="下载 helm 包"></a>下载 helm 包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 添加 gitlab repo 源</span></span><br><span class="line">helm repo add gitlab https://charts.gitlab.io/</span><br><span class="line"><span class="comment"># 下载 chart</span></span><br><span class="line">helm gull --untar gitlab/gitlab</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="内网安装"><a href="#内网安装" class="headerlink" title="内网安装"></a>内网安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">helm upgrade --install gitlab gitlab/gitlab   --timeout 600s   --<span class="built_in">set</span> global.hosts.domain=example.com   --<span class="built_in">set</span> global.hosts.externalIP=10.10.10.10   --<span class="built_in">set</span> certmanager-issuer.email=me@example.com</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://cloud.tencent.com/developer/article/1433261">Kubernetes 集群使用 Helm 搭建 GitLab 并配置 Ingress - 云+社区 - 腾讯云</a><br><a href="https://cloud.tencent.com/developer/article/1471464">使用 Helm 部署 Gitlab - 云+社区 - 腾讯云</a></p><p><a href="https://www.yisu.com/zixun/22871.html">helm3安装gitlab - 云计算 - 亿速云</a><br><a href="https://docs.gitlab.com/charts/installation/deployment.html">Deployment Guide | GitLab</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s 安装</title>
      <link href="/2022/01/03/kubernetes/k8s%20%E5%AE%89%E8%A3%85/"/>
      <url>/2022/01/03/kubernetes/k8s%20%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h1 id="使用kubeadm安装kubernetes-v1-22-x-Kuboard"><a href="#使用kubeadm安装kubernetes-v1-22-x-Kuboard" class="headerlink" title="使用kubeadm安装kubernetes_v1.22.x | Kuboard"></a>使用kubeadm安装kubernetes_v1.22.x | Kuboard</h1><h2 id="文档特点"><a href="#文档特点" class="headerlink" title=" 文档特点"></a> 文档特点</h2><p>参考此免费文档，98%以上的概率，您能够顺利完成 K8S 安装，极个别的问题可以到QQ群里免费答疑。</p><h2 id="配置要求"><a href="#配置要求" class="headerlink" title=" 配置要求"></a> 配置要求</h2><p>对于 Kubernetes 初学者，在搭建K8S集群时，推荐在阿里云或腾讯云采购如下配置：（您也可以使用自己的虚拟机、私有云等您最容易获得的 Linux 环境）</p><ul><li>至少2台 <strong>2核4G</strong> 的服务器</li><li>本文档中，CPU 必须为 x86 架构，暂时未适配 arm 架构的 CPU</li><li><strong>CentOS 7.8</strong> 或 <strong>CentOS Stream 8</strong></li></ul><p><a href="https://activity.huaweicloud.com/discount_area_v5/index.html?fromacct=36cf686d-2650-4107-baa4-f0dc3c860df4&utm_source=V1g3MDY4NTY=&utm_medium=cps&utm_campaign=201905">【云上优选 特惠来袭】华为云回馈用户，产品低至2折(opens new window)</a></p><p><a href="https://cloud.tencent.com/act/cps/redirect?redirect=1062&cps_key=2ee6baa049659f4713ddc55a51314372&from=console">【腾讯云】云产品限时秒杀，爆款1核2G云服务器，首年99元(opens new window)</a></p><p><strong>安装后的软件版本为</strong></p><ul><li><p>Kubernetes v1.22.x</p><ul><li>calico 3.17.1</li><li>nginx-ingress 1.9.1</li></ul></li><li><p>Containerd.io 1.4.3</p></li></ul><blockquote><p>如果要安装 Kubernetes 历史版本，请参考：</p></blockquote><p>安装后的拓扑图如下：<a href="http://press.demo.kuboard.cn/kuboard.rp">下载拓扑图源文件</a>使用Axure RP 9.0可打开该文件</p><p>强烈建议初学者先按照此文档完成安装，在对 K8S 有更多理解后，再参考文档 <a href="http://press.demo.kuboard.cn/install/install-kubernetes.html">安装Kubernetes高可用</a></p><p><img src="http://press.demo.kuboard.cn/images/topology/k8s.png" alt="Kubernetes安装：Kubernetes安装拓扑图"></p><p>Container Runtime</p><ul><li>Kubernetes v1.22 开始，默认移除 docker 的依赖，如果宿主机上安装了 docker 和 containerd，将优先使用 docker 作为容器运行引擎，如果宿主机上未安装 docker 只安装了 containerd，将使用 containerd 作为容器运行引擎；</li><li>本文使用 containerd 作为容器运行引擎；</li></ul><p>关于二进制安装</p><ul><li>kubeadm 是 Kubernetes 官方支持的安装方式，“二进制” 不是。本文档采用 kubernetes.io 官方推荐的 kubeadm 工具安装 kubernetes 集群。</li></ul><h2 id="检查-centos-hostname"><a href="#检查-centos-hostname" class="headerlink" title=" 检查 centos / hostname"></a> 检查 centos / hostname</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/redhat-release</span><br><span class="line"></span><br><span class="line">hostname</span><br><span class="line">lscpu</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>操作系统兼容性</strong></p><table><thead><tr><th>CentOS 版本</th><th>本文档是否兼容</th><th>备注</th></tr></thead><tbody><tr><td>CentOS Stream 8</td><td>😄</td><td>已验证</td></tr><tr><td>CentOS 7.8</td><td>😄</td><td>已验证</td></tr><tr><td>CentOS 7.7</td><td>😞</td><td>未验证</td></tr><tr><td>CentOS 7.6</td><td>😞</td><td>未验证</td></tr></tbody></table><p>修改 hostname</p><p>如果您需要修改 hostname，可执行如下指令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">hostnamectl set-hostname your-new-host-name</span><br><span class="line"></span><br><span class="line">hostnamectl status</span><br><span class="line">echo&quot;127.0.0.1   $(hostname)&quot;&gt;&gt; /etc/hosts</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="检查网络"><a href="#检查网络" class="headerlink" title=" 检查网络"></a> 检查网络</h2><p>在所有节点执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@demo-master-a-1 ~]$ ip route show</span><br><span class="line">default via 172.21.0.1 dev eth0</span><br><span class="line">169.254.0.0/16 dev eth0 scope link metric 1002</span><br><span class="line">172.21.0.0/20 dev eth0 proto kernel scope link src 172.21.0.12</span><br><span class="line"></span><br><span class="line">[root@demo-master-a-1 ~]$ ip address</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:16:3e:12:a4:1b brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.216.80/20 brd 172.17.223.255 scope global dynamic eth0</span><br><span class="line">       valid_lft 305741654sec preferred_lft 305741654sec</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>kubelet使用的IP地址</p><ul><li><code>ip route show</code> 命令中，可以知道机器的默认网卡，通常是 <code>eth0</code>，如 <em><strong>default via 172.21.0.23 dev eth0</strong></em></li><li><code>ip address</code> 命令中，可显示默认网卡的 IP 地址，Kubernetes 将使用此 IP 地址与集群内的其他节点通信，如 <code>172.17.216.80</code></li><li>所有节点上 Kubernetes 所使用的 IP 地址必须可以互通（无需 NAT 映射、无安全组或防火墙隔离）</li></ul><h2 id="安装containerd-kubelet-kubeadm-kubectl"><a href="#安装containerd-kubelet-kubeadm-kubectl" class="headerlink" title=" 安装containerd/kubelet/kubeadm/kubectl"></a> 安装containerd/kubelet/kubeadm/kubectl</h2><h2 id="初始化-master-节点"><a href="#初始化-master-节点" class="headerlink" title=" 初始化 master 节点"></a> 初始化 master 节点</h2><p>关于初始化时用到的环境变量</p><ul><li><strong>APISERVER_NAME</strong> 不能是 master 的 hostname</li><li><strong>APISERVER_NAME</strong> 必须全为小写字母、数字、小数点，不能包含减号</li><li><strong>POD_SUBNET</strong> 所使用的网段不能与 <em><strong>master节点/worker节点</strong></em> 所在的网段重叠。该字段的取值为一个 <a href="http://press.demo.kuboard.cn/glossary/cidr.html">CIDR</a> 值，如果您对 CIDR 这个概念还不熟悉，请仍然执行 export POD_SUBNET=10.100.0.0/16 命令，不做修改</li></ul><p><strong>请将脚本最后的 1.22.3 替换成您需要的版本号（必须是 1.22 的小版本，不能是 1.19.1 等），</strong>脚本中间的 v1.22.x 不要替换</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">exportMASTER_IP=x.x.x.x</span><br><span class="line">exportAPISERVER_NAME=apiserver.demo</span><br><span class="line">exportPOD_SUBNET=10.100.0.0/16</span><br><span class="line">echo&quot;$&#123;MASTER_IP&#125;$&#123;APISERVER_NAME&#125;&quot;&gt;&gt; /etc/hosts</span><br><span class="line">curl -sSL https://kuboard.cn/install-script/v1.22.x/init_master.sh |sh -s 1.22.3</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>手动执行以下代码，结果与快速初始化相同。<em><strong>请将脚本第21行（已高亮）的 ${1} 替换成您需要的版本号，例如 1.22.3</strong></em></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exportMASTER_IP=x.x.x.x</span><br><span class="line">exportAPISERVER_NAME=apiserver.demo</span><br><span class="line">exportPOD_SUBNET=10.100.0.0/16</span><br><span class="line">echo&quot;$&#123;MASTER_IP&#125;$&#123;APISERVER_NAME&#125;&quot;&gt;&gt; /etc/hosts</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bashset -e</span><br><span class="line"></span><br><span class="line">if[$&#123;#POD_SUBNET&#125; -eq 0]||[$&#123;#APISERVER_NAME&#125; -eq 0];thenecho -e &quot;\033[31;1m请确保您已经设置了环境变量 POD_SUBNET 和 APISERVER_NAME \033[0m&quot;echo 当前POD_SUBNET=$POD_SUBNETecho 当前APISERVER_NAME=$APISERVER_NAMEexit1firm -f ./kubeadm-config.yaml</span><br><span class="line">cat&lt;&lt;EOF&gt; ./kubeadm-config.yaml</span><br><span class="line">---</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta2</span><br><span class="line">kind: ClusterConfiguration</span><br><span class="line">kubernetesVersion: v$&#123;1&#125;</span><br><span class="line">imageRepository: registry.aliyuncs.com/k8sxio</span><br><span class="line">controlPlaneEndpoint: &quot;$&#123;APISERVER_NAME&#125;:6443&quot;</span><br><span class="line">networking:</span><br><span class="line">  serviceSubnet: &quot;10.96.0.0/16&quot;</span><br><span class="line">  podSubnet: &quot;$&#123;POD_SUBNET&#125;&quot;</span><br><span class="line">  dnsDomain: &quot;cluster.local&quot;</span><br><span class="line">dns:</span><br><span class="line">  type: CoreDNS</span><br><span class="line">  imageRepository: swr.cn-east-2.myhuaweicloud.com$&#123;2&#125;</span><br><span class="line">  imageTag: 1.8.0</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: kubelet.config.k8s.io/v1beta1</span><br><span class="line">kind: KubeletConfiguration</span><br><span class="line">cgroupDriver: systemd</span><br><span class="line">EOFecho&quot;&quot;echo&quot;抓取镜像，请稍候...&quot;</span><br><span class="line">kubeadm config images pull --config=kubeadm-config.yaml</span><br><span class="line">echo&quot;&quot;echo&quot;初始化 Master 节点&quot;</span><br><span class="line">kubeadm init --config=kubeadm-config.yaml --upload-certs</span><br><span class="line"></span><br><span class="line">rm -rf /root/.kube/</span><br><span class="line">mkdir /root/.kube/</span><br><span class="line">cp -i /etc/kubernetes/admin.conf /root/.kube/config</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>感谢 <a href="https://github.com/zhangguanzhang/google_containers">https://github.com/zhangguanzhang/google_containers(opens new window)</a> 提供最新的 google_containers 国内镜像</p></blockquote><p>如果出现如下错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[config/images] Pulled registry.aliyuncs.com/k8sxio/pause:3.2</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/k8sxio/etcd:3.4.13-0</span><br><span class="line">failed to pull image &quot;swr.cn-east-2.myhuaweicloud.com/coredns:1.8.0&quot;: output: time=&quot;2021-04-30T13:26:14+08:00&quot; level=fatal</span><br><span class="line">msg=&quot;pulling image failed: rpc error: code = NotFound desc = failed to pull and unpack image \&quot;swr.cn-east-2.myhuaweicloud.com/coredns:1.8.0\&quot;:</span><br><span class="line">failed to resolve reference \&quot;swr.cn-east-2.myhuaweicloud.com/coredns:1.8.0\&quot;:</span><br><span class="line">swr.cn-east-2.myhuaweicloud.com/coredns:1.8.0: not found&quot;, error: exit status 1</span><br><span class="line">To see the stack trace of this error execute with --v=5 or higher</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>请执行如下命令：</p><blockquote><p>在原命令的最后增加参数 <code>/coredns</code></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://kuboard.cn/install-script/v1.22.x/init_master.sh |sh -s 1.22.3 /coredns</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果出错点这里</p><ul><li><p>请确保您的环境符合 <a href="http://press.demo.kuboard.cn/install/install-k8s.html#%E5%AE%89%E8%A3%85containerd-kubelet-kubeadm-kubectl">安装containerd/kubelet/kubeadm/kubectl</a> 中所有勾选框的要求</p></li><li><p>请确保您使用 root 用户执行初始化命令</p></li><li><p>检查环境变量，执行如下命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echoMASTER_IP=$&#123;MASTER_IP&#125;&amp;&amp;echoAPISERVER_NAME=$&#123;APISERVER_NAME&#125;&amp;&amp;echoPOD_SUBNET=$&#123;POD_SUBNET&#125;</span><br></pre></td></tr></table></figure><p>请验证如下几点：</p><ul><li>环境变量 <em><strong>MASTER_IP</strong></em> 的值应该为 master 节点的 <strong>内网IP</strong>，如果不是，请重新 export</li><li><strong>APISERVER_NAME</strong> 不能是 master 的 hostname</li><li><strong>APISERVER_NAME</strong> 必须全为小写字母、数字、小数点，不能包含减号</li><li><strong>POD_SUBNET</strong> 所使用的网段不能与 <em><strong>master节点/worker节点</strong></em> 所在的网段重叠。该字段的取值为一个 <a href="http://press.demo.kuboard.cn/glossary/cidr.html">CIDR</a> 值，如果您对 CIDR 这个概念还不熟悉，请仍然执行 export POD_SUBNET=10.100.0.0/16 命令，不做修改</li></ul></li><li><p>重新初始化 master 节点前，请先执行 <code>kubeadm reset -f</code> 操作</p></li></ul><p><strong>检查 master 初始化结果</strong></p><p><code>coredns</code> 将处于启动失败的状态，请继续下一步，完成 <a href="http://press.demo.kuboard.cn/install/install-k8s.html#%E5%AE%89%E8%A3%85%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6">安装网络插件</a> 这个步骤后，coredns 将正常启动。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">watch kubectl get pod -n kube-system -o wide</span><br><span class="line"></span><br><span class="line">kubectl get nodes -o wide</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果出错点这里</p><ul><li><p>ImagePullBackoff / Pending</p><ul><li>如果 <code>kubectl get pod -n kube-system -o wide</code> 的输出结果中出现 ImagePullBackoff 或者长时间处于 Pending 的情况</li></ul></li><li><p>ContainerCreating</p><ul><li><p>如果 <code>kubectl get pod -n kube-system -o wide</code> 的输出结果中某个 Pod 长期处于 ContainerCreating、PodInitializing 或 Init:0/3 的状态，可以尝试：</p><ul><li><p>查看该 Pod 的状态，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod kube-flannel-ds-amd64-8l25c -n kube-system</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果输出结果中，最后一行显示的是 Pulling image，请耐心等待</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Normal  Pulling    44s   kubelet, k8s-worker-02  Pulling image &quot;quay.io/coreos/flannel:v0.12.0-amd64&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>将该 Pod 删除，系统会自动重建一个新的 Pod，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete pod kube-flannel-ds-amd64-8l25c -n kube-system</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul><h2 id="安装网络插件"><a href="#安装网络插件" class="headerlink" title=" 安装网络插件"></a> 安装网络插件</h2><p>网络插件可以选择 calico 或者 flannel（任意选择其一即可）。</p><p>阿里云</p><p>如果您在阿里云上安装 K8S，建议使用 flannel，有多个案例表明 calico 与阿里云存在兼容性问题。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">exportPOD_SUBNET=10.100.0.0/16</span><br><span class="line">kubectl apply -f https://kuboard.cn/install-script/v1.22.x/calico-operator.yaml</span><br><span class="line">wget https://kuboard.cn/install-script/v1.22.x/calico-custom-resources.yaml</span><br><span class="line">sed -i &quot;s#192.168.0.0/16#$&#123;POD_SUBNET&#125;#&quot; calico-custom-resources.yaml</span><br><span class="line">kubectl apply -f calico-custom-resources.yaml</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exportPOD_SUBNET=10.100.0.0/16</span><br><span class="line">wget https://kuboard.cn/install-script/flannel/flannel-v0.14.0.yaml</span><br><span class="line">sed -i &quot;s#10.244.0.0/16#$&#123;POD_SUBNET&#125;#&quot; flannel-v0.14.0.yaml</span><br><span class="line">kubectl apply -f ./flannel-v0.14.0.yaml</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="初始化-worker节点"><a href="#初始化-worker节点" class="headerlink" title=" 初始化 worker节点"></a> 初始化 worker节点</h2><h3 id="获得-join命令参数"><a href="#获得-join命令参数" class="headerlink" title="获得 join命令参数"></a>获得 join命令参数</h3><p><strong>在 master 节点上执行</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">kubeadm token create --print-join-command</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可获取kubeadm join 命令及参数，如下所示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">kubeadm join apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>有效时间</p><p>该 token 的有效时间为 2 个小时，2小时内，您可以使用此 token 初始化任意数量的 worker 节点。</p><h3 id="初始化worker"><a href="#初始化worker" class="headerlink" title="初始化worker"></a>初始化worker</h3><p><strong>针对所有的 worker 节点执行</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">exportMASTER_IP=x.x.x.x</span><br><span class="line">exportAPISERVER_NAME=apiserver.demo</span><br><span class="line">echo&quot;$&#123;MASTER_IP&#125;$&#123;APISERVER_NAME&#125;&quot;&gt;&gt; /etc/hosts</span><br><span class="line"></span><br><span class="line">kubeadm join apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果出错点这里</p><h3 id="常见错误原因"><a href="#常见错误原因" class="headerlink" title="常见错误原因"></a>常见错误原因</h3><p>经常在群里提问为什么 join 不成功的情况大致有这几种：</p><h4 id="worker-节点不能访问-apiserver"><a href="#worker-节点不能访问-apiserver" class="headerlink" title="worker 节点不能访问 apiserver"></a>worker 节点不能访问 apiserver</h4><p>在worker节点执行以下语句可验证worker节点是否能访问 apiserver</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -ik https://apiserver.demo:6443</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果不能，请在 master 节点上验证</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -ik https://localhost:6443</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>正常输出结果如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 403 Forbidden</span><br><span class="line">Cache-Control: no-cache, private</span><br><span class="line">Content-Type: application/json</span><br><span class="line">X-Content-Type-Options: nosniff</span><br><span class="line">Date: Fri, 15 Nov 2019 04:34:40 GMT</span><br><span class="line">Content-Length: 233</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;Status&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">  &quot;metadata&quot;: &#123;</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可能原因</p><ul><li>如果 master 节点能够访问 apiserver、而 worker 节点不能，则请检查自己的网络设置<ul><li>/etc/hosts 是否正确设置？</li><li>是否有安全组或防火墙的限制？</li></ul></li></ul><h4 id="worker-节点默认网卡"><a href="#worker-节点默认网卡" class="headerlink" title="worker 节点默认网卡"></a>worker 节点默认网卡</h4><ul><li><a href="http://press.demo.kuboard.cn/install/install-k8s.html#%E6%A3%80%E6%9F%A5%E7%BD%91%E7%BB%9C">Kubelet使用的 IP 地址</a> 与 master 节点可互通（无需 NAT 映射），且没有防火墙、安全组隔离<ul><li>如果你使用 vmware 或 virtualbox 创建虚拟机用于 K8S 学习，可以尝试 NAT 模式的网络，而不是桥接模式的网络</li></ul></li></ul><h3 id="移除worker节点并重试"><a href="#移除worker节点并重试" class="headerlink" title="移除worker节点并重试"></a>移除worker节点并重试</h3><p>WARNING</p><p>正常情况下，您无需移除 worker 节点，如果添加到集群出错，您可以移除 worker 节点，再重新尝试添加</p><p>在准备移除的 worker 节点上执行</p><p>在 master 节点 demo-master-a-1 上执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">kubectl get nodes -o wide</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果列表中没有您要移除的节点，则忽略下一个步骤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">kubectl delete node demo-worker-x-x</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>TIP</p><ul><li>将 demo-worker-x-x 替换为要移除的 worker 节点的名字</li><li>worker 节点的名字可以通过在节点 demo-master-a-1 上执行 kubectl get nodes 命令获得</li></ul><h3 id="检查初始化结果"><a href="#检查初始化结果" class="headerlink" title="检查初始化结果"></a>检查初始化结果</h3><p>在 master 节点上执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">kubectl get nodes -o wide</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>输出结果如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@demo-master-a-1 ~]</span><br><span class="line">NAME     STATUS   ROLES    AGE     VERSION</span><br><span class="line">demo-master-a-1   Ready    master   5m3s    v1.22.x</span><br><span class="line">demo-worker-a-1   Ready    &lt;none&gt;   2m26s   v1.22.x</span><br><span class="line">demo-worker-a-2   Ready    &lt;none&gt;   3m56s   v1.22.x</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="下一步"><a href="#下一步" class="headerlink" title=" 下一步"></a> 下一步</h2><p>如果您使用自己笔记本上的虚拟机安装的集群，将来打算重启虚拟机，请参考 <a href="http://press.demo.kuboard.cn/install/k8s-restart.html">重启Kubernetes集群</a></p><p>🎉 🎉 🎉</p><p>您已经完成了 Kubernetes 集群的安装，下一步请：</p><p><a href="http://press.demo.kuboard.cn/install/v3/install-built-in.html">安装 Kuboard - 微服务管理界面</a></p><p><a href="http://press.demo.kuboard.cn/learning/">获取 Kubernetes 免费教程</a></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="http://press.demo.kuboard.cn/install/install-k8s.html#%E6%A3%80%E6%9F%A5%E5%88%9D%E5%A7%8B%E5%8C%96%E7%BB%93%E6%9E%9C">使用kubeadm安装kubernetes_v1.22.x | Kuboard</a></li><li><a href="https://github.com/fanux/sealos">GitHub - fanux/sealos: 一条命令离线安装高可用 Kubernetes，3min 装完，500M，100年证书，版本不要太全，生产环境稳如老狗🔥 ⎈ 🐳</a></li><li></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kubeboard</title>
      <link href="/2022/01/03/kubernetes/kubeboard/"/>
      <url>/2022/01/03/kubernetes/kubeboard/</url>
      
        <content type="html"><![CDATA[<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://press.demo.kuboard.cn/install/history-k8s/install-k8s-1.21.x.html">使用kubeadm安装kubernetes_v1.21.x | Kuboard</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql AppendQuery</title>
      <link href="/2021/12/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/bugfix/mysql%20AppendQuery/"/>
      <url>/2021/12/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/bugfix/mysql%20AppendQuery/</url>
      
        <content type="html"><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypeError: object of <span class="built_in">type</span> <span class="string">&#x27;AppenderQuery&#x27;</span> has no len()</span><br></pre></td></tr></table></figure><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><blockquote><p>  级联关系 修改为 <code>lazy=&#39;dynamic&#39;</code></p></blockquote><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>使用AppenderQuery的 count 方法获取长度</p><p><img src="https://i.imgur.com/uRyUKuZ.png"></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://stackoverflow.com/questions/45723102/how-to-get-length-of-query-result-sqlalchemy">How to get length of query result SqlAlchemy</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
            <tag> bugfix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>arrango 批量导入测试</title>
      <link href="/2021/12/29/%E6%95%B0%E6%8D%AE%E5%BA%93/Arrango%20DB/arrango%20%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%B5%8B%E8%AF%95/"/>
      <url>/2021/12/29/%E6%95%B0%E6%8D%AE%E5%BA%93/Arrango%20DB/arrango%20%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="ba4ac9f11b7c63e92c9d669d7b3dcbe35fbb81fecac5268137c1ed500010f2ab">a8896663a075a62411bb5095d4322c699a045991c4bca83378b9b0275aeafd2576450762e17b6c2306190924c7ca6f08873f83515c1e273356b22334897658c12aa16acd1859e9bbb1f23ba35285bae5e8466c5ccd6104d4dfed36a9621cd82620b55efb33a5fce2ab24a90a0e54d1ad83206ace2fa7f47b79d9687b623d11415da88396e066758089b1bffb569238b328f14e6fb7bfa43e5fbe7881097cbc1b7d63a36bcf77ceb3eccee4bf8d4d538b252b208a85812ff879497678a6daed84b3bc85763ba0cd9b47c8ec095822cf7e4865980315ec31802cf58e8481e23334c26f930629566f84f023764ca881732683f410ee92621c0e87d2ca055582f18b61b1466defa9ae99960d8e6c65101141ab5d2be7ac8fc4f28ef57a0abd8d0600c6b869b1a1e05cc1a51fd6884b91c768c56b67510077caf384753724aa1989a0b5eb9cb3da85bd6a5443b8c9330f450ea8eea9b91d1bfb60e60f4f4ab5db6e3fc491ab1fb078f720f1743d0095eea381abc1ddd05a0c27036b81a601b52c6b84a9b307991649702f308cffeb69a5855164d48f5457f6c401f3ba0ab2c735ce6c9145ee360443bfbbcd4194083ec5f9583eb390d2b13605171ae1154980808e4588f04e8cffba90a931502800c85b8a5eee409d1b653c62daeba7bd9e3b862b14a4e51dda64e852ae60175c3dd99dd589f3c5f2cb88c1849cbd215051473f55ac26137bb7ed9adb6c5e8757ee0a13a9705b6795aebb091802f939f7db6e05126509ec730199da263df4ddc459e009e8add4afceb2495d10befcd93bb08f735496c555068d546814fbeb90aeb879050705ed2e43410482db98db979d082264bdb468c7c95854f39bfa4cd3b1ef3d92a98b8c4052086150661c672004c16a4aee127559457d674b13573101bb8fc6cef8dca160c0dcc0eee2bb14bae407f878492da8a51041494fd757635d89bb84dd998bd0b534c0441ea96f3c2d43bc4621defe0cdfbd00e28a2d4a32b3972ab724057635a58c87c81a6d6bd26a1cfbea1fa25ebfa853565a875e55cc8b5482b4632f9107b1f01de4f08215f923efba772675e9b3ce48e4388d8d5a4ceb2dc6ade14fb9d072e0eff383f8284845aa1a1d7e5d48c137235343f686d2d15d6d5afdf2309bd056cc56ebc414c9e761d472af750874eb434ca772e526d94e74655efe8f3154f3e3dd31c3507abfcae5bef26bd9ed956f7105788a677124ceaef58e9e66401dbc0fe3681401117c7d760032cbde1bf17fd64a01b430ee4670f59128f9eb0d10b51a40bc770aeb2131ceb7eb51ac70b5c0d9c00608d01799f070e418e6aee2315da35e8822ec50dac022723684bce2a4202852510631d80aa7c87a321cb7f7f2866da43b3e416e12011a5201a4b1cf5d4e91bce6e617671aed1478e430e2cf96f4f7d7c88a93a9da5cc608672ce89efaf3dc951682609248230421bee34323a44464fd34d8e6ad529594cc8fe179be084464e4282e73dd70401e5e3ec9d5cc80b33b1af09a4bd2bfdc85405926bbe683976258e8eb1f57a9a75d29ddd4437ca74a3387009a5a742c23e2aaf37bb65daba801f7d95943ed591b98f26306a4b4431ab46ae9e74a1638da51973ac4671d5296c1ff32787cc6fb5414e60fe0e5ff9ddb4d77644191c630f2d49f5342e3a1bb1e2290523a7c68e7b6f2996abdaea4586048197ef9e81dd2222bd2b8478446531c9b0e146928d51efb2cf175f6985e479dc05ac07b391f1e83a30032cf9d9befe5655bdf7fb6dbe8daa5a1824e339f4eed7bf68b9620923f7ab079778ed1f482d30cc5871a0e457aea39a2f03149dc0e6d060d203e848a283899edcd70f63146b48365f270cf2741bf16b54880057212385c4fcdbfe6e1122968f5b7c97786567984dc9c80148dbae4c0222da18eda7ef7b11f9ef2652c3dc4509d6fbc35ad6c012a0d8236f601b001b35c2b3462cc9bee52206fa9605225d29acbea157f6082ec04462c360fc4da09ce24aa9eec2402bd4cc5fad52a81ae297a483a2e4cb2ced4446085d4de1cf29eb53d8124a7dbd1d50e2088e96e233f201ec647014ef79a6f9c9668047637fe52030a3ec324eac97149dd4d16b596a7d2a558abb769ab401c7208f5c8f5c64f5e24e09a4761afef9445755143ee72533ff1fd8fd7f737e2aaf4a1f99397a2d860f8df7a1f3c0918c80b3470450851e4a2ec11f3dfd7f2c0790a4d7f87e1c6e6d93e1ef495c33fec686eeee1624d9068068cf88f59222494ec81f6a662457cb7c55e12bbf054fc5f8efe0a2166876b3c0ef2978cb2008940c9ef47b9f59f6e03f365e8aef44c255695d0232582c85cf2948fd9b4d0f9f3d3d47e13dbcb7eabc01143d32ca1658b2a389b77ebaa8cd16a762abc5eb0305bf0b006c18b436f8374b894a5cccceacc60f4295c32f4b63e46872193057b649af941a360505833ea6b2869940b9c4c5f03fcff7cd961ec3d3f1e8e21eb1c5a44412b39f76b8657f9e633815e0a282a871cfc942a559e787789eb7ae0a91aac4a8a49fd10ee544713eff59e5af8a11a6b04a6cdc914ce8708fd33039d03b698f27312860d8a914e535f4e73b4f44ae771757bacd4d316d9dd34a451daba2bf889002839f4a9b44804a382f70dd73877d327e61306b9d6fec37e2f64dd7ba0edf229717004e86be78e94c592862dbb5af8f3f37db02a16a28837b45647d0c37f3eb65691614e387d37edea5a31dadb6bddca9521beef1eb9dbe006717fb7a50c13ba8914fbd0fff43f7a5e85a8c9b535cdfa956d705cd68e3045b558225a74f38c09cf2b616f487cf402fabdf4afe315d018fc6676b0eb16aab08652ab71c2affbd83318840aa61dc99f792ad037431fef65d4444db678ce80f8ac253cfcb6263bb496d2567ccddf74eaff42e9124a5b4a51afe2b18f4ae818348e3401c2327e7f069c0c5371b66664675fb2ff9ca34ed3311e910b8931ee9d848f7ceb77b066bab4b620f92563dd3021e3ccb9c6ad8e0d4081ae6263b7582d20a38f0ff290be383e5e6036be6209de5ea48a6ee30673596b8c4bd0ddf522a8f6788e49d4b860c2bd4c57d1f4c0f9b05b8cfffdc4025df25e7573e4ec11585557291df436d944b9f98c9a3cac5efae1fe984b265553aacc72dac8a68055a2c03ae2ec4af1d54ae7ee89c806acd4ed9677e57127fc1f83a488a20eb3b83977859095611f3eb2d5cfe1578b85f4d8093df226c76fbbd957d0bb5c682439ac5a7f303a1e5e0606231e58b4ae17020506d6f43f67c4418f5fe0a493f158afce89b039bb53cd81138cfe78f18fbfdfe57e9ae922b5c0504c85ce061f6b615755e3a31e18a488e8a2b845ec64f65da59b9ecf5837de79c6f52d91c6bc192e49a0c639580f90a68d3c32b8638933cbfc5e5f53a3c45e6ccfcf21fa76a45e31ba270315c5ae79bba6eb928e2337754ca9e18ae6617faad1f55993f2231193a659f26e3ae4fce34d9058a2242adb3f7d2a13669aa2024a1e0002203841409262790d4932d8786854a0382ad0a65e066b061fb293031f3e24aec3422e3a304382ed417d13e31d9b34a6b0910f2bf90823d398058c64c00a9e89dd19071c786926d199080dcaeb57cd24b6e6eedfd0f4f2c1100516e24886d24f08879865d0c15858dd39cc5656438a9099e289bd849f56f7d865b26ddb4e2247ed027c9887474961548a6806aae67e4a12b7d8f3b27fce01baf56819f64af54ff5dd1252cd22d438bd1f931355b0499b778f3bec559e481035349c7f4cd98e7f657c21178ddbca7b6c6c33c2b5bce9d33ed156b676e8deacf416308157c7c5191e06fcf0676f9952c14af9c0f1ec3cdbd65564a145054fecded9ccf443aedd0173949b20964301afd5045ea9c47403666f99f67d3e7e85694834614937e61968e71330e693f5f31d7d51d3170e800f4ee92955f9ac9a45ecce27ca6e2242fb36441943ee0527fc383cecec6020e0690adea9f34cab50548f2c66e05d9de538da92c22d08f8295150d5a53a71b1a9d81826620f3eb3756c8fec0faebbd6eb79041cc4c7c6153368dab0b51fe13a4e5d2d55c4aaf365dcc0c39ca47e16f5b1c134eddebb4e9fea8f28b661bfccdff8e747e13606cd41a5a16ca20d775ea3f6fb952cb55ba50e00c0e44ab99e6979bf26dcc3cea5002ef23b053eb0e4723110a562a12cf56ea7194c49e1cd7fb9bd1c29d0e1299973ee3069c8a21b0b4e5233e64ddb27a4804a790ea92ffd0b8c299fb2992ab8f874e4dba3153b265a9503d78438ee04571fbd7fc224d6708ad28b4477c78703cb5455000afcf3322b4b7b49451934c7713026534a51810f0c2d91f0967bb56ab5b4aab1c22ae43bbb311e464014a91d8b8605f4430d3f5d1e8e2427ea1394ba5b25923f639d15b547f79c29929b01e12f20df0604bf951aa99b38611b0eb147c63ca593cc25f0e9601fa78860c1c64eb29790c20f66e695c425d492b3a836a0e012f2389e6424d17d487eb18f4b87357cf5b519f4337ab5c39e41311c6967ac1466395612ed68a14f2734631e8ec975f85cf1d7a08aab23288cf2fd8ca2e071ff2c79b3203e701a152caf01910f039e7686174ddb9ca3453304426b182266a578a0609feee37d2b97954b946db56158280cad4029ead55fa023009735563b9ffed06f8ea6645b13478745e843aa46e98891c60e800260488bae05dbee432cd38e97f0d04c119cc59f10b50b9fa469bed7ec4b63df9491edef273caba222697e70947887bbc4fd4b08a3d5d6046b3298277d80efe779aa5b9785a58859ae54d6df8a64cd149f98e6a40ad67e0ca6c63a61655b01ce5d285dfc8b7d95425dc76fe7fe7bbc6fcc125f3267adc04dca8d92c5a2013b69c3427847a5f6abf0a3c4d5bc46cf829fc50d59a60c143ef95febb61a0adb0709b1f96a7717c06a0e1a6f7e5503826d5d1c8e532703a4aa3abeb4bcf948152a832e4acc154c19a1cf158653a9c24b3286b31ffb97979ec4d51bf387db65df58e7e1ef6a444433e6fefccf7669f0b4a78b48dce316d4303ddee21880ec8ea04696ab701b41434614b218d0c1879ee72799b3b6c633b548dc802d8b32604462c4e839ec58e4d72d61a056b9386cd3ec77dd0072281492988a4d58a792f8f9b2c05b8f945e1ac5ffee5339fb55c6e6106b53f83650b9606c467fe84e30c8df0d8743ea9f94ca862feca40227e6b0675d932303588c99f3bc71c87f31c1fcea2eedac1f8f50a37546c5fe13758ccfb370e8c0c16a23246f68e9e4c40835f7f4f7a4311ea6836559fd8fde53e07dafa19b74d6955b0727611083c7246707053ff8f20879fd4db5e4d1938c8f46bea1ed304297351c274416f54a11b1e4f3b8c77dea212f1bb169b999c2a915498f39e719970ecf8506e2c425c8eeb51f4508fd1253a53f826f6901622ea986eae91d314e349a38474c06c3be7567186cfe153efc10ed7ecd859ea88d720ac015a4a25bce5bcecc90b5fd50e1890fb6a49ca262d3d11fd69db893f34f9cadcf218ca7efe93323932fb5fc90f2ed5b6f34330f303be608bbc8e809bad88a2c74ab150daf74407e7d66fe4bec1f09a565992f5af94b2331407e1be01b8bfb8fc3396847250a47924eeec2bcd90ad4be90c86018f1de4ead409f1394e1034dd11e4ea5bec8aaffba174cc0e51bbed39623f67885104fa81c27894077f3be8f457c26f5eb1291d178ebfd1cdf3245fd37f415997c7cc3416f1a903e6cb2eb9aa7434c3fb056117060ddff3036668344fac23f641e5533cc552d9827fcf92728d14f0bc476c5742f4b20b036487b2099d265ed8ddd3e05ba0ea241b8361748dee4894cbe3cc3cb469c02abc8bc8bc158ce2119f709968b9a4d2a7daa2b6ce578f2fffb532496402efeccc9f9dbb312126039e4bf272e82262a772d72ec99207c120c020d7627e4508129b3582c06c76115c01ca5c72371f153fe4c7ddad35a3a40dcfb7b40c2a0cc1829466696e22191300c6e42cc6c7cce4cc66cfc89962cb372ee85e56f17ba7eda525ad44474f228b2cda184aad6f9b50bd5809e823786da04d1a78dad647310ef38a512d10ea3f6cc3ee5e99614b6a735cc6306073e488d6cce657b3e5b4cff7247691410beba52196abb98e4f13ea820caccc828ad02b612f395997edb714e048d2ef19651885533c665cece2a0fb3999b9893498217f37b89b485f533b96ca9cb2b5fb440c80d9b459f82b4899d043a0041b3ebe1909a69446bcf94598310be6a90517e265b4d8a92cf8d30bea5ab65ca8336564cb9ecba36bcf7d323f52309fa940f32ee70ba211d585846c21a611c069d78b9d34139d36f5b309003f0358f75d884f8d8fe35667d9cace37328e8d0afbc41e66c83ccc572d84500bff100082fb835c27fb4fa6dd754688806f605f0fc1a7c77fea8206bd873518b5d781b0b6e7ec0387bf0f5b3aed927fa7b272ec360de16a9a07e14d13e0aa94ecdd5d495e388c222681cb06a8f555389fbc5267b3c61238dc024a7e7f09d8abcdbb9db40e49364ac45de72c9a5dd48296ecfdecefd84e83db0ef347271b1dca5ba7716d69fa2bf0a9967388015550ee4407e99529dfc3873bc01b5a2dc8aee8194a27af9351183b2090281b3aaf309b6d66a024d72d99b4ebf969e59cf21f5c7ad9aa46f92137190a140cca156223e300822aef82cece0175ae93b325c24c56b94c7b7fc43a37a3645d2f2292663dbf23eba30cb68cd48deaa234d943d810380080842ecbdf7fca57393142614894511913eed3b34f29ba98dfe47c330e851722ce2045a4bb590fa9cb9203f00d94a5ceb824e970ef382cbeead7c1a377eb6575ccf3ca2b78f0bce9a5dd3115d774d77240f4e62150ec7bcc4b265dabe4e6d6c09804f612980a85d8e5cd907e6323f0b889728b667c65d07fba838b6c7bcb985f9a499eed41734b1decf88a7cedd2072d4f4242d294cc4d08f4ea462f62834b7a0192e22df54d50cbb2f4a2425cec52b6704f0701179067ae0318541fafac67efeedfb57a2487f2926c8fdce4df281a48a5801526fc5a981d2b4f31dd18040454b267649aad9e9c4a037cda7ea3204e00017ac7c82af6e7e05050ccb7f89942d35838a1ffb6c64b556b1fe2d9609099bae830cf873f20b22c5e2aa49d0709c067f814f21e9b4ecc5c4b4d2f39b2964f4ddbbce0552cc70a5ea0932fecc8efcced87b7f22b86f939c5ee8e21908a20695463d9b6a8ce224f4dce6104ee1b16e9f22298c785e7bc2001dc06d8286e4dfbc8bfaf2eb1260c4bb2f0a2ba6ab157c58425fbfefa3e95fc247a0c5f6b206ea4368915c25ac65b74d221b817c69f9c5a5b9f9758884f3466a118d548ef68c12412d68a34e601c0824492d726db135b20afb2d66d626faca91ca2480e5eefa92197b3bb185b6b47af85d2fa4eabb8bfb0945bc9641af6737bbcd0b00854edea769a93ea413b946a8116be92273f90df1ef57e6f3324ce8a5f7d7125dcc4748a3080899f5a6981b23556df763636b76a62dfdd4f80aed593bf7fd01d2077242752584cc85fdc991a9c18dba31af8637a9de75a204ad9c05b1544d62b8fd2b31cbefb144dfc99a7c95d477a3d51d0565465d3ce1f68208aeaeaa95ba4622576113cefa01cea76cf1c4100ecb548ff0199271aa7d609c4e2747aa0c9e7c1a08ef8c1cd7742c6037e0bfb588cf7520113f4cc1dd06bef0035ed6a6f8140344202d34e0d46d14f9e7d55628ac70863f7451e8046c226a1acf5f5484d6081a75f4e2d36b7fddcd00a12cd48c81c5895fbf7db04ccf3a65bb7bce3967cb241b4f5d35b97677d2d838acab987ed705696e05e40cd5e68f3ff84cfe14ff68eb01d42906def4c63a2acc0d51314ee587ca3623a5e1dbc15ab2fa39ce3f4d5453641e6fa1e1506048e14c47ec0d8f28078e89931e373915096a8dcb9ed542d701e3b74acbac0f6038d7273dc496e866b73965babd274cbe1f698e8c879c02ed139281891357a29f44bb5b3731e5eb97f698b496d24d0fb6ed5be40fd6c42cd1bdcb6fa8f4970b0478af2308ce52a89889f6995fdbf2891339b4faa827e38ee711c6b81c88c409761991fe56cb3821fdbf961fe115fe4256f0240ce5e69d0880ce4d5fa0ba4bcd0dbd7470ed5c829d0cd6c3609dc3c89efef465faf779380078f42f14a117565e4775a103571b72d6b6b3bbee81875ab12fba5225ceeb0d18c2ae201330939042bba3e096e9b3c863f67e383d9abdcaf8348ab5e39f870f8c971de912302c7dad9c694ef8c57825d0987d9fd9834e5954f72f90c11111d26950c8d4232eb69c53ab88b75bb2e977a60867e172c24736aa4b1b066ba5b565e77e78d0d0a826adcee7bbc89eb4e1ea4622e594fc6f98ff47d4f3aa069f62b8b53451c5bb32c187948711ebd9bdd980dcaa22aa419f3805f560e43fc1da1e19842a1c70cdcc68b8a2a75ec823e40b40611d57f6b1e3ae24e293b12cb2b08a271112340fe86853c8b7329bddfa36c32ae4bcd5cc8d091d03cdce57401466234164103f63f8b69c2ec904ba363f59fbc18cf8b1c2ab20d2c8953a69f702a5c09212ec2e556d179244345742d3c3f7d5ffc8c43e5c5f1e27ddf231726fb3c4359a7e3cf25bfc77a2fedc09bcb72a90611eca7dc616741e8a86f63633ff449863ac31acc07627c91fe11015b8ef660e2ea38c099793e8ac2085f109fb660d264502b4d99d091540ade132657fcc755ae23f30342f38d58ed66882fdea1f50b87565fb5101884283ea7a56e019a4e5939d86719b17ebb8cec4afa7afc8b3647487fab7d6b06dd6d8496b4dc25576c427c17f6e5de8241235b3e8a80e4e32fcc3a43070321056e63c5ecade15ccd925d9f28b758998095a5796169efc82648dbb31926775b6c561ff55090d85d4a290571f6a7539f82788629513441b69c04bea54c96db4b522f1b1f687df3bc103649a8959784078fdd692dfad8872e2c85c25affd26076c470558496de0b890a6147d052c1e7a0b056ebed02fbbb1582dfd7797b4fd70ce9664781ce679e0accaa52fd0e93d193bca0601e9de6053d22b646a1176f1e81c8da1f01b3cd6510e48752ed67a56b0ee444e6f2ae870965296a768a3a2080ee35f82228704a2d2275c0616725cf1ef26f91288b54c476e9c330f1d9404cf48bdcaa44f95f7ef4fe7f1c86d2a50961cd763452aa4759092ae2062226dfa13551a2413569eaf901160ba14ee6e944ff0909a57e7dfbd4769c51c0723081c7685b911344b9f03806444c230815bc4bebfa57feaa6ce61308ae72363611376ca11c6a739574040fc76fa39d4e13ccae68c9544c1742bec5f1fd5330a7ab9f383da971ecc4197271cfbbcee5cba944094a537a34c47c60986a372c2fa8328847e560b0534185d8ed91f222fcd7e37f4a57a778dc558dcb8dbd2f1c1c01d374d1d1d8df8346921a49ab1171d40a980c5963d575a6739d42a6bc1f7d4fd6f89f5c28b910c81fe6552b85c4ec94a415f5a9f8f5db776121482100f3c2873c4d5fa841118a53083915a2cfb4a2701a8a19e4c71da55b4c2fa574055a25f01b1532b0d36410911ffa93b4a7d9dd30b701d63c934b8358c81d70e9d0bf7e5a5c1f1fed036442975dac3bc8df47098a2e75249e5d2b98f010b3df46ec1a762a77f870e056d593089d4ebe45748229d457ae81717daeef9428bb9a2a9a938861b2e4758bd9d07c03772f642730e61457f02dd56b90eb562c54bee953196a6576ac17d71336edf4fe0c1103136f0d7441bd702fe4190873e7beee9799146d7da29e8e4308c4ac5566b92e6d80ec0b0b12555e6fd35f1b5ebea5661ee126e1743afd0503414a8028d12289d515c0fee74093afff714230e2f6af9f32dda878d77371d2247dfc121c09f4670353752d79093b7490f2c73897d3282c8a7f60f7a87c1f9b5d3b25f297a7a032e20221762b3fda99eb2ba6850ead511103ea1c0c26d545b3d85258a81b58a310aaf899f6636c5fa82b131f0b7981db121147c6a4e90e1ff7b033646b7e108a0fff15568b4ce49c275f5a51a7c1686794cf181d34d3a70a97af15801a1b8c78413ea6fa31e0b16bc41691b51dd2911072835d567da8af6d9c890636bde5558117a01dd109d138d78daa66a152db886c5fbbaa4e6a8337021dc45c6a605db37c3cb820990f69cd765cd1f0abaa38a82e57ea05b4e05b7306ea8f16138b09320f6948ac5a360a04edbbc4b99922b7bfbd66ecfc6cfd020aabf7ac78d0b61cea899d3e86f5b9c36bae30d59c56cdb32ef39433a818ff01808c7011f936d06b9c55f424b17867686dfbb5e6a256f1f2851b7bd7d121b14c31aa7415faa44d7d9d0cd76adc5817606a14549457dba764782ba3276d4e5c249bd03ae416311bf12354ea4be9f7ee75bb1d64f7e611474c410e11eb17aac78f5986301ee66bb8aa7c5e65439f2497b81a8b895c670df4f7f83b01c8bec808cd5f51235dfddd040da9d916be48dac5b78d0f2539deb2433a494ca9168d708d3fc58e65fc20e9012e5f18b5ec056c515261da2da5fbe60b016f3035c8b48e35d5f54e7de5e9cbec218a5e1db4adf47cfe81bb5c520fb8a5439f2450278976de0d5267dbb12ee697b23e0ef691c790d02b4121f976f72ba4d528c8adc85a321d3c68bfd678c0f7261e8b0fa0bd5e0838ef2e09856ae400681928c3554000f3a121a84690b9006a7ccc6e5ab28c82777fab1336931bc28d6c2bde2965e71f96a2dc4f7f2e452e5d8a5870977e9e2ab211ff25d59e9450ff3d96139dbcea3bb7dd725845147f4b086abb6d4744a0ffe83f055a0446d9edc51b87c347ac1e589c823605eaa068d172346d5a625501652ec492707e299d6620269cdcf5178abf507bda52639e9600e57574e1a258ffb72232be346148d6cdea9bf10c08be598925e74efe586a2ad1df410188cef75a0ee787bb6995310937b201c3c6191e6532c588085c52b0a7bc60226d51e445de5b78b2bef8d43f2c9235f9f24627c7e2f2fafc267747cfeafeca776cfb26950745df3bda0ee0dbcab8588cbd43b36300e59506d3967699a8811336e679c25891d9346680013fb85bd20ad9cc8d73a14e7e6b903d06a5bc2be176f6b0a0c88ab2667387c44f6b8c669536251f7374e906d697db49feef5f4b77d940c45a1bf56b4c712a218ff8133d75900436b85898f7353aa50bc26e2f162ffdcbe377e52959db158165c77815778fa3471d0d1546b30e13ccbac901f4d5c763f0f8c7db6344d16c843b118925712eded587e85617bd3be16b9b2aff95b561ac7edfb8df6f6b4e803bb6de993dbc4e88c1b83d6eafcdbaa714e708a1d954049758715af66bd47463c2036f09d39dc6fedea0a08880d700e346b65aa4b95f7effb6c4e73231d6e21c8c08cd20b7825996f495af3d20dcdaf5461ca33441895ecc6f6e6d6441ec9275a91aa2c43c9d43fd17a72c859dc63617db9aafa2c93473bfdd4126c582655b46dc14a888b984b4ce5d68b296e61e99f2ca526bc9ee9695b07dd5e47ea4449ea1ca3d904217d662748b162d7eff66b2f6f10ae9c8c578423bddabf847c53e3407f954a655f0db9e106e872dd3f8e397e33b0521788e840292b15c5fe831dfd8aa92649ef4a87fa6c6c6bd8d2242fb9b7a85b6f27d991052b1d22a0e84d2223005b088e44d341eb071d1cff74188bcf61ae3cbd304cee986d3fa6cf9f68cb8b6a94945402b7cc4ad13cd0f24acb3823258ccef76d6ab105ce2202a0a1cc9ea72ac57a80aca022cf0b05fcd1dc11f9c659f4ab773d1c49a5735176c5503b6a8e2cccec64aa6cebe08917593c2f1e6961ed8810ffe8284362a72ee91a070529a4117e12a261f6d53cf5044434f18c92f77ba79d4e461a2725450f0d5622930e16c1223c2c59a52407c8ba41c9c53e95cafe766c7ac44dded607b6bb3a7484223539cf79de83eee767f395f66f7c030461af45f4eeb6c30c13f40d6d5ecc3822d35f73d792fa2b6a45a9d3ec958706789ce7af4496487e881c6f9e3f356e05a5051d128138b83aac087987ef1558d7f97632698af023940850b6f43d1de356c102d0671427a2ee54406f0ce7208c941d21b245cee2dc10686218327ebe4ff72ec2c61e4d77819a7f0cc8169c4973594a2e6499bc479a640348a6927257b8b285c319e64e56b89f68103e55fdf1244e8b366c7a58577853776fedafde70144f9e2e654c8e4a097db0dc957ae2a1c0744031deb8843fb23083f3d6c622b0f66525d92ec56fb2aad7c9cdda5bf684fe6c5c17cf990380b8768a27eff96c96dce6875cb3057513dc6fd509774832a4e8dfd22b7d15ef2fe4ed39bccf52f3e9af5b376244d62047f2910138ee0e38f2a8c556ae5234d8281081fd7576b2e613e331725828d43de6ff35b5ded3fcdc00fff4fbf83c7a4ca6b912df602e93a584154a88a6c3a75e1c415a97c966f090bbca7f4220d98974edc463dfde29d2b5d43343ba51ae574347ec691996c79a87bbb80d1e80e1bff598524c4a4348fdb743989382d7e6238a1a57b1ababbdf574d7b8de7977afd0af1f85eba16084750e58df9cf597a2aa9bb48f146da90dd31daa144a13a4478aebefcb545048e87408f8629b013bca06d19fb4e99da8578014820bec72bef3907f01110736303bc9aebc103e089cbd5b6c71b5f575b75509891c91562300c1a7c04d2e91090d49ea43ef09a741923380956ba50442ef1b977ebff27f7b92a5c941e858317c18f329237671e60b6ce7b8bf12d5ebb024315c6d6159fd9a7a6a817d8144cf58e726e471fbd239629e51a7528485d1f9fcdc3c6e2f047cd292ca87baa6fb285c5a2e7ce1328f0fab1a38ae29f4d95ae0416f56fc725335e36a1456d367da5ed52f766889367c53537c3f9e9d38f48f36366dbfa66c47741f10c34b01d884906e29449157c1ba6ad4a32e8c8e234732d0c3f989ed94b0cf1dec73072795b4d6824e15bf989ba9b74eec1bdf357dab6b2d92ac6ac1ade528411c9e36a3e8a90fd3b95db971d3430bd42b964ef29892ba9b52630dc30c0968d5930241c8fe90858f12ce85582b71eb326cf3dce4e0e71c9a38537b0a6c13528190f467a33df4d6ac6e0c16bdbf32cb032fe8e7c68d824f388d5693636cbbabdec3f3cc8d446475457826ebca63afd8703496071490581ddc63eeb89588b5eda91e6492038644dff4db012288f5754dd7fb71048da2a0f1a162770db3c5112e6658322a40a60a484f6cec10407dbcb87781b865b915ffbee978cdf007a589cfd4e9681a1011ee810fd0bf8ddcefeff7d99659907875e0ca91b5b38c50bc0a6789877d8979a17f951f84e99f7cc6a3d348330b2b8965cedb698b7435de22a5875e5f68c8001f7cde5d8e0cffdd449100ec7dc53ea9dee6e69fed6beb07ce15a5c02a22aeea778975755ddc331faac2aa9eaa01cb1d56d9eefd82840e51cfb814c116165412e5063541b7a48b134a6862a0903291c50d4ea11f591a1846ef89ee4396bcc0729f3a78f8588db6bab4ada2e41900f13aedb85e268051b77e3c67c19e5f77f62a4cec040922a98e5e9d2ef489e880e28138c7a67068d4a74203e7d1643cbb20fa4e8389127f2c6924d5b22e57ec0bb6213c6b015a93ae391db37d1f17517875dddb3396fea277bc3421e0327b941ffd8c1d94c47677524f434e67aada7c6b41c5c926af527742736900afcc541b17b3b3c16f2ff4ff94d5099d9979bbb3e1207e6090f3c3a07e93514864e8c542411ec0640f23f042e442bebdfdd507a9b37582836c68ef166e09b11c834f7600359d339c3629a779aa2d9ab420b093efeaee5f48b457521f89383007353fbda2b4bf0d9ef6db59de94810d78ae80c37f69cdb5c94ed39ebe1e302aa275a072089970415c99d79e5fa4676b588c8cf719db779b0bb96639a8f82657ac2192eb8164122280ab4125d01c9ea33e673b90b87ae5583f917c20296383efc7c059ee61cd09dd55849bcfa27da123b44b0f55d9c25b31be9ccbd7e532adc83eec058766288284bb59365a3f87597522a9798d0c24d51cdf5beb84167e883f7d34aec95ac85776cf1991c204575c3e72e3e586b0d2f6b38fad29bc61b6825b9d3198ce970d6162c7f9c069c7eda0b6d25eea3ae259532ea3b4b4f2a20778ea20a358b4e6b045dcb215b61b675cbd1d9903f880a4c016b5914211f68ee653d7674f2e983e1ba0b361c04717539fb5d52defcc7ef75d555d522bb94a22a4b7c9338268cf2410c54f1d6fc73f9a179675a60403f04cc191a3ea03772704f6a177f8212e609a037a1b042508abccff7061931974f3be1321e2083600b7a46fccf0e63702f8f7cf116494b35b5cae5e72fd4d94f41ab47f63bcca39c3e2b31e936f3bd5f6895916caf8aef778bce69b01c82279b1311044f605e5a19370921b0e29922818237f387562db57c16762fcad313f82b7d296665091853929a9a704600e8a4fb305bba16ad9f6f8a9b245d0694ade4660c838f97d2343438839be65083a10f9348e24276187d9ccfbd1cdd3fe31168bca84a2ffcb746b27eb7c9de2654f0ddd64061818258872ca9705703317b9518a27ab1683b7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-wave">      <input class="hbe hbe-input-field hbe-input-field-wave" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-wave" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-wave">您好, 这里需要密码.</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-wave" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> 数据库 </tag>
            
            <tag> Arrango DB </tag>
            
            <tag> Arrango 探索 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>obsdian 学习</title>
      <link href="/2021/12/27/obsdian/obsdian%20%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/12/27/obsdian/obsdian%20%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="插件学习"><a href="#插件学习" class="headerlink" title="插件学习"></a>插件学习</h3><h4 id="mindmap-插件"><a href="#mindmap-插件" class="headerlink" title="mindmap 插件"></a>mindmap 插件</h4><p><a href="https://www.bilibili.com/video/BV1344y1k7qK?t=25">Johnny学OB 第2集 - 自动生成思维导图，一键做视频笔记时间戳，OB的这些功能，可别错过了 | Obsidian 黑曜石 教程_哔哩哔哩_bilibili</a></p><h4 id="PDF标注插件"><a href="#PDF标注插件" class="headerlink" title="PDF标注插件"></a>PDF标注插件</h4><p><a href="https://www.bilibili.com/video/BV1YQ4y1C7Fy?t=29.3">Johnny学OB 第13集 - 在OB里直接标注PDF，可以高亮，标注，加页面备注，当然也可以加标签。大大提高用PDF资料进行学习的体验。Obsidian教程_哔哩哔哩_bilibili</a></p><h3 id="看板"><a href="#看板" class="headerlink" title="看板"></a>看板</h3><h3 id="任务管理"><a href="#任务管理" class="headerlink" title="任务管理"></a>任务管理</h3><p><a href="https://www.bilibili.com/video/BV1bL4y1z7Fd?t=53.2">[Obs＃54] Obsidian的任务管理技巧汇总_哔哩哔哩_bilibili</a></p><p><a href="https://matthewmeye.rs/obsidian-kanban/How%20do%20I/Add%20an%20image%20to%20a%20card/">Add an image to a card - Obsidian Kanban</a></p><p><a href="https://www.bilibili.com/video/BV1iZ4y1X7xW?t=54.1">Obsidian Kanban自动修改卡片标签_哔哩哔哩_bilibili</a></p><p><a href="https://matthewmeye.rs/obsidian-kanban/Settings/">Settings - Obsidian Kanban</a></p><h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><p><a href="https://jasper1024.com/jasper/20210914033602/">obsidian + hexo = my blog | 默</a><br><a href="https://github.com/avirut/obsidian-metatemplates">GitHub - avirut/obsidian-metatemplates: Take advantage of YAML front-matter in generating notes from templates (for obsidian.md)</a><br><a href="https://github.com/garyng/obsidian-temple">GitHub - garyng/obsidian-temple: A plugin for templating in Obsidian, powered by Nunjucks.</a></p><h3 id="个人主页"><a href="#个人主页" class="headerlink" title="个人主页"></a>个人主页</h3><ol><li><p><a href="https://www.bilibili.com/video/BV1k341117vt/?spm_id_from=333.788.recommend_more_video.3">Johnny学OB 第34集 用OB搭建个人数字主页，高效整合你的工作、生活和学习，挽回那些被浪费的时间 | Obsidian 教程_哔哩哔哩_bilibili</a></p></li><li><p><a href="https://www.bilibili.com/video/BV1mq4y1d7KL/?spm_id_from=333.788.recommend_more_video.-1">Johnny学OB 第35集 用OB搭建个人数字主页 第2集——利用Admonition插件让你的主页更清爽整洁 Obsidian教程_哔哩哔哩_bilibili</a></p></li><li><p><a href="https://www.bilibili.com/video/BV14u411Z7sJ/?spm_id_from=333.788.recommend_more_video.-1">Johnny学OB 第36集 用QuickAdd 快速记录你乍现的灵感，以及Button和Sidebar的用法 Obsidian教程_哔哩哔哩_bilibili</a></p></li><li><p><a href="https://www.bilibili.com/video/BV1qQ4y1q7Gs/?spm_id_from=333.788.recommend_more_video.-1">Johnny学OB 第38集 用OB搭建个人首页收尾篇，用Quickadd, Kanban, Buttons 把之前的坑都补上吧 Obsidian教程_哔哩哔哩_bilibili</a></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> obsdian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>K8s常见问题：Service 不能访问排查流程</title>
      <link href="/2021/12/22/kubernetes/K8s%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%EF%BC%9AService%20%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AE%E6%8E%92%E6%9F%A5%E6%B5%81%E7%A8%8B/"/>
      <url>/2021/12/22/kubernetes/K8s%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%EF%BC%9AService%20%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AE%E6%8E%92%E6%9F%A5%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="kube-proxy-报错"><a href="#kube-proxy-报错" class="headerlink" title="kube-proxy 报错"></a>kube-proxy 报错</h3><p><code>graceful_termination.go:93] lw: remote out of the list:</code><br><a href="https://stackoverflow.com/questions/58860745/no-route-to-host-from-some-kubernetes-containers-to-other-containers-in-same-clu">project calico - No route to host from some Kubernetes containers to other containers in same cluster - Stack Overflow</a></p><p><a href="https://www.coder.work/article/7317214">kubernetes - 从某些Kubernetes容器到同一集群中其他容器的主机没有路由 - IT工具网</a></p><p><a href="https://jishuin.proginn.com/p/763bfbd4d120">K8s常见问题：Service 不能访问排查流程-技术圈</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitlab ci cd</title>
      <link href="/2021/12/20/linux/gitlab%20ci%20cd/"/>
      <url>/2021/12/20/linux/gitlab%20ci%20cd/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.bookstack.cn/read/gitlab-doc-zh/docs-204.md">Using SSH keys with GitLab CI/CD - 《Gitlab 中文文档》 - 书栈网 · BookStack</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定时任务框架 ndscheduler</title>
      <link href="/2021/12/20/python/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%A1%86%E6%9E%B6%20ndscheduler/"/>
      <url>/2021/12/20/python/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%A1%86%E6%9E%B6%20ndscheduler/</url>
      
        <content type="html"><![CDATA[<h2 id="需求背景"><a href="#需求背景" class="headerlink" title="需求背景"></a>需求背景</h2><p>在应用系统中开发中通常会遇有定时任务任务开发的需求。 python 的定时任务框架有<a href="https://apscheduler.readthedocs.io/en/3.x/">APSScheduler.</a>  通常的这些框架都是面对后端开发的。 定时任务的开始， 状态监控, 日志查询， 这些工作都需要开发后台维护。 因此需要一个针对定时任务的UI框架进行任务的维护与监控。 </p><h2 id="选型对比"><a href="#选型对比" class="headerlink" title="选型对比"></a>选型对比</h2><p><a href="https://github.com/rq/rq-scheduler">GitHub - rq/rq-scheduler: A lightweight library that adds job scheduling capabilities to RQ (Redis Queue)</a><br><a href="https://github.com/Nextdoor/ndscheduler#web-ui">GitHub - Nextdoor/ndscheduler: A flexible python library for building your own cron-like system, with REST APIs and a Web UI.</a></p><h2 id="yaml"><a href="#yaml" class="headerlink" title="yaml"></a>yaml</h2> <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attr">kg-pipeline-scheduler:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">environment:</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line"></span><br><span class="line"><span class="attr">env_file:</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">./data/global_config/global_config.env</span></span><br><span class="line"></span><br><span class="line"><span class="attr">image:</span> <span class="string">dockerhub.datagrand.com/yskg/kg-pipeline-scheduler:test</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">./data/kg-pipeline/data:/kg-pipeline-scheduler/kg_pipeline_scheduler/data</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">./data/kg-pipeline/process:/kg-pipeline-scheduler/kg_pipeline_scheduler/process</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">./data/kg-pipeline/pipeline_template/custom:/kg-pipeline-scheduler/kg_pipeline_scheduler/pipeline_template/custom</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">./data/kg-pipeline/logs:/kg-pipeline-scheduler/kg_pipeline_scheduler/logs</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">./data/share_data/oracle/instantclient_11_2:/opt/instantclient_11_2</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linxu 时区</title>
      <link href="/2021/12/17/linux/linxu%20%E6%97%B6%E5%8C%BA/"/>
      <url>/2021/12/17/linux/linxu%20%E6%97%B6%E5%8C%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="设置时区"><a href="#设置时区" class="headerlink" title="设置时区"></a>设置时区</h2><p><code>timedatectl set-timezone Asia/Shanghai</code></p><h2 id="同步时区"><a href="#同步时区" class="headerlink" title="同步时区"></a>同步时区</h2><p><code>ntpdate pool.ntp.org</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker 安装</title>
      <link href="/2021/12/16/docker/docker%20%E5%AE%89%E8%A3%85/"/>
      <url>/2021/12/16/docker/docker%20%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h1 id="docker-安装"><a href="#docker-安装" class="headerlink" title="docker 安装"></a>docker 安装</h1><p>yum  添加 docker </p><p><code>yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</code></p><p><code>yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></p><p>yum  下载离线包</p><p><a href="https://www.cnblogs.com/testway/p/13235683.html">docker离线安装</a></p><p><a href="https://docs.docker.com/engine/install/binaries/[[install-daemon-and-client-binaries-on-linux]]">Install Docker Engine from binaries</a></p><ul><li>修改数据挂载</li></ul><p><a href="https://blog.csdn.net/z924139546/article/details/104228516"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker 安装ngrok 并配置</title>
      <link href="/2021/12/16/docker/docker%20%E5%AE%89%E8%A3%85ngrok%20%E5%B9%B6%E9%85%8D%E7%BD%AE/"/>
      <url>/2021/12/16/docker/docker%20%E5%AE%89%E8%A3%85ngrok%20%E5%B9%B6%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="docker-安装ngrok-并配置"><a href="#docker-安装ngrok-并配置" class="headerlink" title="docker 安装ngrok 并配置"></a>docker 安装ngrok 并配置</h1><p>Created: May 9, 2021 3:58 PM</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">docker run --rm -it -e DOMAIN=<span class="string">&quot;ngrok.17beauty.vip&quot;</span> -v /root/ngrok:/myfiles hteen/ngrok /bin/sh /build.sh</span><br><span class="line"></span><br><span class="line">docker run -idt --name ngrok-server  -v /root/ngrok:/myfiles -p 81:80 -p 444:443 -p 4443:4443 -e DOMAIN=<span class="string">&#x27;ngrok.17beauty.vip&#x27;</span> hteen/ngrok /bin/sh /server.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="nginx-配置"><a href="#nginx-配置" class="headerlink" title="nginx 配置"></a>nginx 配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">map <span class="variable">$scheme</span> <span class="variable">$proxy_port</span> &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>  <span class="string">&quot;8080&quot;</span>;</span><br><span class="line">    <span class="string">&quot;https&quot;</span> <span class="string">&quot;8081&quot;</span>;</span><br><span class="line">    default <span class="string">&quot;8080&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      80;</span><br><span class="line">    listen      [::]:80;</span><br><span class="line">    listen      443;</span><br><span class="line">    listen      [::]:443;</span><br><span class="line">    server_name ngrok.fengqi.me *.ngrok.fengqi.me;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass  <span class="variable">$scheme</span>://127.0.0.1:<span class="variable">$proxy_port</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate /opt/ngrok/ngrok.fengqi.me.crt;</span><br><span class="line">    ssl_certificate_key /opt/ngrok/ngrok.fengqi.me.key;</span><br><span class="line"></span><br><span class="line">    proxy_set_header    X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">    proxy_set_header    Host <span class="variable">$http_host</span>;</span><br><span class="line">    proxy_set_header    X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">    access_log off;</span><br><span class="line">    log_not_found off;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/53c72ae1446c">自建ngrok服务实现内网穿透</a></p><p><a href="https://blog.csdn.net/random0708/article/details/105778056/?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_baidulandingword-2&spm=1001.2101.3001.4242"></a></p><p><a href="https://twindy.org/nginx-ngrock-net-through/">Nginx配合ngrok实现内网穿透</a></p><p><a href="https://fengqi.me/unix/409.html">[原创]搭建自己的 Ngrok 服务器, 并与 Nginx 并存</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>创建私有仓库</title>
      <link href="/2021/12/16/docker/%E5%88%9B%E5%BB%BA%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/"/>
      <url>/2021/12/16/docker/%E5%88%9B%E5%BB%BA%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="创建私有仓库"><a href="#创建私有仓库" class="headerlink" title="创建私有仓库"></a>创建私有仓库</h1><h2 id="1-下载Harbor安装文件"><a href="#1-下载Harbor安装文件" class="headerlink" title="1. 下载Harbor安装文件"></a>1. 下载Harbor安装文件</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//github.com/vmware/harbor/releases/download/v1.1.2/harbor-online-installer-v1.1.2.tgz</span></span><br><span class="line"></span><br><span class="line">tar xvf harbor-online-installer-v1<span class="number">.1</span><span class="number">.2</span>.tgz</span><br></pre></td></tr></table></figure><p><a href="https://yeasy.gitbook.io/docker_practice/repository/registry">私有仓库</a></p><h3 id="Harbor-仓库创建"><a href="#Harbor-仓库创建" class="headerlink" title="Harbor 仓库创建"></a>Harbor 仓库创建</h3><p><a href="https://www.jianshu.com/p/327b7b607d87">docker-compose 安装Harbor</a></p><p><a href="https://cloud.tencent.com/developer/article/1444530">Harbor – 搭建Docker私有仓库</a></p><h2 id="docker-统计"><a href="#docker-统计" class="headerlink" title="docker 统计"></a>docker 统计</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctop </span><br></pre></td></tr></table></figure><p><a href="https://linux.cn/article-9508-1.html">分享|cTop：用于容器监控的命令行工具</a></p><h3 id="docker-服务更新挂载"><a href="#docker-服务更新挂载" class="headerlink" title="docker 服务更新挂载"></a>docker 服务更新挂载</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker service update --mount-add source=/nas_data/yecg/fmkg/kg-extract,target=/kg-extract,type=bind  --publish-add 41808:8088 --image dockerhub.datagrand.com/yskg/kg-api:kg_extract_dev project-waigaoqiao_deploy_kg-extract-parse</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>问题集合</title>
      <link href="/2021/12/16/docker/%E9%97%AE%E9%A2%98%E9%9B%86%E5%90%88/"/>
      <url>/2021/12/16/docker/%E9%97%AE%E9%A2%98%E9%9B%86%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h1 id="问题集合"><a href="#问题集合" class="headerlink" title="问题集合"></a>问题集合</h1><h3 id="Error-response-from-daemon-Cannot-restart-container-f6-OCI-runtime-create-failed-container-linux-go-346-starting-container-process-caused-“process-linux-go-319-getting-the-final-child’s-pid-from-pipe-caused-quot-EOF-quot-“-unknown"><a href="#Error-response-from-daemon-Cannot-restart-container-f6-OCI-runtime-create-failed-container-linux-go-346-starting-container-process-caused-“process-linux-go-319-getting-the-final-child’s-pid-from-pipe-caused-quot-EOF-quot-“-unknown" class="headerlink" title="Error response from daemon: Cannot restart container f6: OCI runtime create failed: container_linux.go:346: starting container process caused “process_linux.go:319: getting the final child’s pid from pipe caused &quot;EOF&quot;“: unknown"></a>Error response from daemon: Cannot restart container f6: OCI runtime create failed: container_linux.go:346: starting container process caused “process_linux.go:319: getting the final child’s pid from pipe caused &quot;EOF&quot;“: unknown</h3><p><a href="https://www.cnblogs.com/yanglei-xyz/p/container_linux_go_346.html">OCI runtime create failed: container_linux.go:346</a></p><h2 id="docker-网络问题"><a href="#docker-网络问题" class="headerlink" title="docker 网络问题"></a>docker 网络问题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service docker stop</span><br><span class="line">$ sudo pkill docker</span><br><span class="line">$ sudo iptables -t nat -F</span><br><span class="line">$ sudo ifconfig docker0 down</span><br><span class="line">$ sudo brctl delbr docker0</span><br><span class="line">$ sudo service docker start</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fix BUG</title>
      <link href="/2021/12/16/kubernetes/Fix%20BUG/"/>
      <url>/2021/12/16/kubernetes/Fix%20BUG/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">min_depth: number (default: 2)</span><br><span class="line">max_depth: number (default: 6)</span><br></pre></td></tr></table></figure><h1 id="Fix-BUG"><a href="#Fix-BUG" class="headerlink" title="Fix BUG"></a>Fix BUG</h1><h3 id="1-kafka-启动报错"><a href="#1-kafka-启动报错" class="headerlink" title="1. kafka 启动报错"></a>1. kafka 启动报错</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2021</span><span class="number">-03</span><span class="number">-16</span> <span class="number">05</span>:<span class="number">42</span>:<span class="number">12</span>,<span class="number">957</span>] ERROR Exiting Kafka due to fatal exception (kafka.Kafka$)</span><br><span class="line">org.apache.kafka.common.config.ConfigException: Invalid value tcp:<span class="comment">//172.21.3.194:9092 for configuration port: Not a number of type INT</span></span><br><span class="line">        at org.apache.kafka.common.config.ConfigDef.parseType(ConfigDef.java:<span class="number">726</span>)</span><br><span class="line">        at org.apache.kafka.common.config.ConfigDef.parseValue(ConfigDef.java:<span class="number">474</span>)</span><br><span class="line">        at org.apache.kafka.common.config.ConfigDef.parse(ConfigDef.java:<span class="number">467</span>)</span><br><span class="line">        at org.apache.kafka.common.config.AbstractConfig.&lt;init&gt;(AbstractConfig.java:<span class="number">108</span>)</span><br><span class="line">        at org.apache.kafka.common.config.AbstractConfig.&lt;init&gt;(AbstractConfig.java:<span class="number">142</span>)</span><br><span class="line">        at kafka.server.KafkaConfig.&lt;init&gt;(KafkaConfig.scala:<span class="number">1235</span>)</span><br><span class="line">        at kafka.server.KafkaConfig.&lt;init&gt;(KafkaConfig.scala:<span class="number">1238</span>)</span><br><span class="line">        at kafka.server.KafkaConfig$.fromProps(KafkaConfig.scala:<span class="number">1218</span>)</span><br><span class="line">        at kafka.server.KafkaServerStartable$.fromProps(KafkaServerStartable.scala:<span class="number">34</span>)</span><br><span class="line">        at kafka.server.KafkaServerStartable$.fromProps(KafkaServerStartable.scala:<span class="number">29</span>)</span><br><span class="line">        at kafka.Kafka$.main(Kafka.scala:<span class="number">68</span>)</span><br><span class="line">        at kafka.Kafka.main(Kafka.scala)</span><br></pre></td></tr></table></figure><p><a href="https://github.com/wurstmeister/kafka-docker/issues/122">Invalid value tcp://10.0.35.234:9092 for configuration port: Not a number of type INT · Issue #122 · wurstmeister/kafka-docker</a></p><h3 id="2-pvc-pv-不能删除"><a href="#2-pvc-pv-不能删除" class="headerlink" title="2. pvc pv 不能删除"></a>2. pvc pv 不能删除</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n yskg  patch pvc yskg-pvc -p &#x27;&#123;<span class="attr">&quot;metadata&quot;</span>:&#123;<span class="attr">&quot;finalizers&quot;</span>: []&#125;&#125;&#x27; --type=merge</span><br></pre></td></tr></table></figure><h3 id="Kafka-manager"><a href="#Kafka-manager" class="headerlink" title="Kafka manager"></a>Kafka manager</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># ./bin/zkCli.sh</span><br><span class="line">[zk: localhost:2181(CONNECTED) 2] ls /kafka-manager</span><br><span class="line">[configs, deleteClusters, clusters]</span><br><span class="line">[zk: localhost:2181(CONNECTED) 3] create /kafka-manager/mutex &quot;&quot;</span><br><span class="line">Created /kafka-manager/mutex</span><br><span class="line">[zk: localhost:2181(CONNECTED) 5] create /kafka-manager/mutex/locks &quot;&quot;</span><br><span class="line">Created /kafka-manager/mutex/locks</span><br><span class="line">[zk: localhost:2181(CONNECTED) 6] create /kafka-manager/mutex/leases &quot;&quot;</span><br><span class="line">Created /kafka-manager/mutex/leases</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Volume</title>
      <link href="/2021/12/16/kubernetes/Volume/"/>
      <url>/2021/12/16/kubernetes/Volume/</url>
      
        <content type="html"><![CDATA[<h1 id="Volume"><a href="#Volume" class="headerlink" title="Volume"></a>Volume</h1><h2 id="Storageclass"><a href="#Storageclass" class="headerlink" title="Storageclass"></a>Storageclass</h2><blockquote><p>要使用 StorageClass，我们就得安装对应的自动配置程序，比如我们这里存储后端使用的是 nfs，那么我们就需要使用到一个 nfs-client 的自动配置程序，我们也叫它 Provisioner，这个程序使用我们已经配置好的 nfs 服务器，来自动创建持久卷，也就是自动帮我们创建 PV。</p></blockquote><h3 id="部署阿里云的nas-做为-sc"><a href="#部署阿里云的nas-做为-sc" class="headerlink" title="部署阿里云的nas 做为 sc"></a>部署阿里云的nas 做为 sc</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nfs-provisioner</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">nas</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">nfs-provisioner-runner</span></span><br><span class="line">   <span class="attr">namespace:</span> <span class="string">nas</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">   <span class="bullet">-</span>  <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">      <span class="attr">resources:</span> [<span class="string">&quot;persistentvolumes&quot;</span>]</span><br><span class="line">      <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;delete&quot;</span>]</span><br><span class="line">   <span class="bullet">-</span>  <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">      <span class="attr">resources:</span> [<span class="string">&quot;persistentvolumeclaims&quot;</span>]</span><br><span class="line">      <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;update&quot;</span>]</span><br><span class="line">   <span class="bullet">-</span>  <span class="attr">apiGroups:</span> [<span class="string">&quot;storage.k8s.io&quot;</span>]</span><br><span class="line">      <span class="attr">resources:</span> [<span class="string">&quot;storageclasses&quot;</span>]</span><br><span class="line">      <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>]</span><br><span class="line">   <span class="bullet">-</span>  <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">      <span class="attr">resources:</span> [<span class="string">&quot;events&quot;</span>]</span><br><span class="line">      <span class="attr">verbs:</span> [<span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line">   <span class="bullet">-</span>  <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">      <span class="attr">resources:</span> [<span class="string">&quot;services&quot;</span>, <span class="string">&quot;endpoints&quot;</span>]</span><br><span class="line">      <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>,<span class="string">&quot;create&quot;</span>,<span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>,<span class="string">&quot;update&quot;</span>]</span><br><span class="line">   <span class="bullet">-</span>  <span class="attr">apiGroups:</span> [<span class="string">&quot;extensions&quot;</span>]</span><br><span class="line">      <span class="attr">resources:</span> [<span class="string">&quot;podsecuritypolicies&quot;</span>]</span><br><span class="line">      <span class="attr">resourceNames:</span> [<span class="string">&quot;nfs-provisioner&quot;</span>]</span><br><span class="line">      <span class="attr">verbs:</span> [<span class="string">&quot;use&quot;</span>]</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRoleBinding</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">run-nfs-provisioner</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nfs-provisioner</span></span><br><span class="line">    <span class="attr">namespace:</span> <span class="string">nas</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nfs-provisioner-runner</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">alicloud-nas-controller</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">nas</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">strategy:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">Recreate</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">     <span class="attr">matchLabels:</span></span><br><span class="line">       <span class="attr">app:</span> <span class="string">alicloud-nas-controller</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">alicloud-nas-controller</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">tolerations:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">operator:</span> <span class="string">&quot;Exists&quot;</span></span><br><span class="line">      <span class="attr">affinity:</span></span><br><span class="line">        <span class="attr">nodeAffinity:</span></span><br><span class="line">          <span class="attr">preferredDuringSchedulingIgnoredDuringExecution:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">weight:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">preference:</span></span><br><span class="line">              <span class="attr">matchExpressions:</span></span><br><span class="line">              <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">node-role.kubernetes.io/master</span></span><br><span class="line">                <span class="attr">operator:</span> <span class="string">Exists</span></span><br><span class="line">      <span class="attr">priorityClassName:</span> <span class="string">system-node-critical</span></span><br><span class="line">      <span class="attr">serviceAccount:</span> <span class="string">nfs-provisioner</span></span><br><span class="line">      <span class="attr">hostNetwork:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-provisioner</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">egistry.cn-shanghai.aliyuncs.com/jieee/alicloud-nas-controller:v1.14.3.8</span></span><br><span class="line">          <span class="attr">env:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">PROVISIONER_NAME</span></span><br><span class="line">            <span class="attr">value:</span> <span class="string">alicloud/nas</span></span><br><span class="line">          <span class="attr">securityContext:</span></span><br><span class="line">            <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/data</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">nas</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">/data</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nas</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">storage.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StorageClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">ali-nas</span></span><br><span class="line"><span class="attr">mountOptions:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">noresvport</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">vers=4.0</span></span><br><span class="line"><span class="attr">parameters:</span></span><br><span class="line">  <span class="attr">server:</span> <span class="string">&quot;abcdefg-hijk.cn-shanghai.nas.aliyuncs.com:/&quot;</span> <span class="comment"># 服务地址</span></span><br><span class="line">  <span class="attr">driver:</span> <span class="string">nfs</span></span><br><span class="line"><span class="attr">provisioner:</span> <span class="string">alicloud/nas</span> <span class="comment"># 此处需要与控制器中的PROVISIONER_NAME保存一致</span></span><br><span class="line"><span class="attr">reclaimPolicy:</span> <span class="string">Delete</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.kubernetes.org.cn/4022.html">kunbernetes-基于NFS的存储_Kubernetes中文社区</a></p><p><a href="https://kubernetes.io/zh/docs/concepts/storage/volumes/">卷</a></p><p><a href="https://www.kubernetes.org.cn/1146.html">Kubernetes 中的 StorageClass 和动态卷供给_Kubernetes中文社区</a></p><p><a href="https://www.yuque.com/xiaowei-trt7k/tw/nbn41g">13.Volumes · 语雀</a></p><p><a href="https://blog.csdn.net/m0_38039437/article/details/109516958">k8s-NFS Provisioner 为 NFS 提供StorageClass的动态存储动态分配卷-8_Bruce小鬼-CSDN博客_nfs-provisioner</a></p><p><a href="https://developer.aliyun.com/article/713441">Kubernetes环境中使用NAS动态存储卷-阿里云开发者社区</a></p><p><a href="https://www.lingjie.tech/article/2020-11-07/22">K8S配置StoregeClass(nfs,ceph-rdb,cephfs,阿里云NAS)</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kuberneters kafka</title>
      <link href="/2021/12/16/kubernetes/kuberneters%20kafka/"/>
      <url>/2021/12/16/kubernetes/kuberneters%20kafka/</url>
      
        <content type="html"><![CDATA[<h1 id="kuberneters-kafka"><a href="#kuberneters-kafka" class="headerlink" title="kuberneters kafka"></a>kuberneters kafka</h1><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><blockquote></blockquote><ol><li>kafak deployment 环境变量需要调价<ul><li>name: KAFKA_LISTENERS<br>value: PLAINTEXT://0.0.0.0:9092</li><li>name: KAFKA_ADVERTISED_LISTENERS<br>value: PLAINTEXT://kafka:9092</li></ul></li><li>指定hostname<br> hostname: kafka</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zoo1</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">zookeeper-1</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">client</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">2181</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">follower</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">2888</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">leader</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">3888</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">zookeeper-1</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kafka-service</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">kafka</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">9092</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">kafka-port</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">kafka</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">&quot;0&quot;</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zookeeper-deployment-1</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">zookeeper-1</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">zoo1</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">digitalwonderland/zookeeper</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">2181</span></span><br><span class="line">          <span class="attr">env:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ZOOKEEPER_ID</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ZOOKEEPER_SERVER_1</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">zoo1</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kafka-broker0</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">kafka</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">hostname:</span> <span class="string">kafka-service</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">kafka-service</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">wurstmeister/kafka</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">9092</span></span><br><span class="line">          <span class="attr">env:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_ADVERTISED_PORT</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">&quot;9092&quot;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_ADVERTISED_HOST_NAME</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">kafka-service</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_LISTENERS</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">PLAINTEXT://0.0.0.0:9092</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_ADVERTISED_LISTENERS</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">PLAINTEXT://kafka-service:9092</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_ZOOKEEPER_CONNECT</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">zoo1:2181</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_BROKER_ID</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">KAFKA_CREATE_TOPICS</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">sample.topic:1:1</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kafka-cat</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">kafka-cat</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">kafka-cat</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">confluentinc/cp-kafkacat</span></span><br><span class="line">          <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>]</span><br><span class="line">          <span class="attr">args:</span> [<span class="string">&quot;-c&quot;</span>, <span class="string">&quot;trap : TERM INT; sleep infinity &amp; wait&quot;</span>]</span><br></pre></td></tr></table></figure><p><a href="http://www.smartjava.org/content/minimal-kafka-instance-for-k8s/">Running a minimal Kafka instance on K8S</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kubernetes</title>
      <link href="/2021/12/16/kubernetes/kubernetes/"/>
      <url>/2021/12/16/kubernetes/kubernetes/</url>
      
        <content type="html"><![CDATA[<h2 id="kubernetes"><a href="#kubernetes" class="headerlink" title="kubernetes"></a>kubernetes</h2><h3 id="k8s-快速安装"><a href="#k8s-快速安装" class="headerlink" title="k8s 快速安装"></a>k8s 快速安装</h3><p><a href="http://press.demo.kuboard.cn/install/install-k8s.html#%E6%96%87%E6%A1%A3%E7%89%B9%E7%82%B9">使用kubeadm安装kubernetes_v1.22.x | Kuboard</a></p><p>Created: March 12, 2021 4:11 PM</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><h3 id="中文"><a href="#中文" class="headerlink" title="中文"></a>中文</h3><p><a href="http://docs.kubernetes.org.cn/">Kubernetes(K8S)中文文档_Kubernetes中文社区</a></p><p><a href="https://kubernetes.io/zh/docs/home/">Kubernetes 文档</a></p><p><a href="https://www.yuque.com/xiaowei-trt7k/tw/gd08dk">31.k8s集群安装prometheus-operator · 语雀</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>打污点</title>
      <link href="/2021/12/16/kubernetes/%E6%89%93%E6%B1%A1%E7%82%B9/"/>
      <url>/2021/12/16/kubernetes/%E6%89%93%E6%B1%A1%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="打污点"><a href="#打污点" class="headerlink" title="打污点"></a>打污点</h1><p><a href="https://www.cnblogs.com/zhanglianghhh/p/14022018.html">Kubernetes K8S之Taints污点与Tolerations容忍详解 - 踏歌行666 - 博客园</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>配置私有化仓库</title>
      <link href="/2021/12/16/kubernetes/%E9%85%8D%E7%BD%AE%E7%A7%81%E6%9C%89%E5%8C%96%E4%BB%93%E5%BA%93/"/>
      <url>/2021/12/16/kubernetes/%E9%85%8D%E7%BD%AE%E7%A7%81%E6%9C%89%E5%8C%96%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="b7ea662f3bd94e5c3d17acbe6cfabc3c8fae182b562e38885566d26656e5e24e">a8896663a075a62411bb5095d4322c699a045991c4bca83378b9b0275aeafd25da6c534a93653aee92a921ccb6ac738da9aea4989a7d8400520897f2b3bbacf1443a59a32b862497aadda356ce9fe466f290a652dec7eb90dfabe00979e078ab6046e4e902818ef1456e0bd3016b0e11d38797085dc43694ac2dfd1b3e4c1037d717086d92d281cacf20f671245382b8a7ffb3a505b0bbda1e2df8673fab88d2099a5b4701aebeb58b5387a26ad046ba4b35c03300f89a576bf1a72d5e54524e976a74644f93076f6949d96d9b5a4ac84e4696ff4e2ae3bc1e7a3be896be7d08f2a8d8cf11d1e8e0de738c21eec3c9055d4b33f01b716e09b2547e3e38e119fd3f8ff3fbd9d41a5293fd6fb7ec2fea26bc6784a4810e44c14604c5508c09f03f3f4958d6b241f271189626d0a6214bb03c16fd379a69668963beb7100aef62f24ee94fd3d19dfc93ed12c86ae92e527fd5370c83c26f158186af9d24354aec1e49ce97fe5c158fd4d51d327107a55fbd039571a28d7b35daa205838dcc96af7ada9ae00794a87bd53561bbad2bbe91ca258b35b4ffa689bca912c7b477499cb0134d24ae010aac5581e89c2e7940cfaf1a5110e769be58db0d0532624d72d2850af55274eb93c917975edac321a86497fc137cd0abaac3e161947ae8a06197141fd46c10eb06f5f47aae00922100bb89b4b0d8af1102ca1ec1eea5e1164a55402697ff7370e10f6beb6423a3b73992af8508cb9ae00ec82299b6b82fb61e5903977e1c534fa0b52c8663165c0c1d5e481e996299e4c6dd01aa659198c0bd4f64f5cc960a2b8a49f6ddb539d8ff14a9bf9ff2e2215c2b96d699332502db86a7d43245c3d85748880cf072411b050e9ab3d0330efc7003c53ab0d91a36cab4f29a127a6d4bdc1af1b4166eaffc6fe13a03567343f761850b8f2ca37ea3017ab51a7052cdc1174dac3b43e97ffe4112d83bbc7d2b4bb4b1f0982849b96e4f88c7142e3093ff06967bc2315469f1ebf67fd890bcff72a2c2bfd51aff346e2efb35ccd91144d9ab44618e3e23108ed339cc39f711b7a0331bc110889bb28ab8e273edfd640023b1dcc3fb0e971b7a3acc186c4b6b438c9ddb717fc2a2f12baad85d745d193a409377356504069a71242759a0289f533f9497020c70d258139c8c9e555b457ff3b4590ce1a5c50eead0e43ca3a8aa3eee11005622bba152e420bfa73b496270d37ba5c41fb1082dfbce23b39b0ed0f2b50218826274a061589f22302d99753e7e5884fdaf372b9ea0573149408c2ba1d16a8994fc9b925138572a9e49320a96910053079d960799a65f3b43c6b5d53269de93554f5d70e06c2f4d03306c358767fffc6fe04d46fcc935a7c9ff34733d91bd257f407006a60ed0ecf7ec0954c10569dbfaf106a56a7e1d729e700ae33bd028d06fe66cf2fe6480ccd7be0ab8ec8231741aa4def66de5d674744ae177d68c1ed91b29300016b139315577e62f07d3e60792fe3f68aa0bf43678776dfdab7a23c815bb5e869ad334cfb906e1bcff7f96729ed95fc70fc4aec3901f61591f13501fea1751b63b3ad84d7408e5b3f73ee901fe2bf88a4816c4342471400c6b3d94d86f0393e9ef274327be6b5bc25e9dd72809da439470c7e3df9ea6b5b1ca1919f69b3bab4e10fddd686f5afd9739ac3dd143f3fb585b2d0b9c3da97feb7b59c41065a6d6be168b80e1c727a4c0b018f9fc27619789b145056c1d013591f5c3e04cd157e340420bd6b3e6e32b99ae5bc7296fe24c939d81cf5f343fd505da37e8a62b21e0e6b0f0e3f24508bb750c811f1cb9ceadf75b2b1ca8cee06c54c20c81548721fd16dc5f65dde1d66ab4cfa0bae1cf9e6f39b01dbdce94aacc6974e19df5b250ae3abd062ce5c084398c033ca7d88de8534055832645ba2370b9f8f8f909c49b9c981d485f82dd89da8bafe2a0ce99b8928b901277fd5a2da46ff8e6fd5dd17e165e5cc02a28a308d1bc68b051737aa4c10b549c426753fb9a0a87afafae786ba4abb2dce2188cac1fa0fad893d15d0559264d2f11bd9edd8893721aee47a693b60c734a55761e3a4b9a6cc313df6a2763146b3b53abbc8ad733ce805b214a13188d68bd735256377fe06e154a19b86c499e1dfacfb97cdaefda792c867a361d27066c734a6f8597cd220b319e67194fb08416a63b4527e83658e872aca84720b6e7dcacfb5326569e38d3498cb5df63f28486565592c9c32c84b4ff7ffb52d9f79135314bcaf9c819c24835cd81598e3b975d2710254aa277e60724e71be04c058bf97959c550b2a81f26eec8fd22576c7938253f68eeb46133473c33032f195089aae4373fdee05328d222cbac23c50f1dca877540da3e78c531b491445aef52967e8fa5202805f9fd715dce8123be98a21cf233f5d094b849c83a12fad88f888cc96d930a1d4ad5131bca964c242fe076f9341690aca10c7c22535889b38d157ba7dfdac765e1d0f5206345ccfa800921708fb932b1091dfa2ef155bdc74f2f35e6b50f8419b443c87a65b6699d024d94bfdaf500b1ed74b5907262c2e9db7560f30205e7dd7db29155f1b55c6ee1fc9a11e3fe08bf819e912f0834f06dfe08a261ea84faec2fee17858e071b5690c92e57cf3a148312c76023f03c843b0bb88f5345aea20b434a9d50d544247f0330d9dacb9526a5eb9b9f647e6635e99c98b3b807468cbb6c340f87310888fe02f020460e7bcec41d7197c1dbaa89a2578c999ff1a8455cbb9aea4843e91cac19aca595c1e2e60e3243a43fcea31a2048064be6b3b10be90d0e3dee7449b4ce05c0b9264307a85fca8d07747364ff263f159c2eddd6a1f2236294af3584e8b8d6ba0393298e4d36562f075d6d23c76969bad0e073d7d4b0e9d4c55d605033851299c4c84224886d33814a38253b5ec76199fa94b801916f3df760359cb81ac6f451516daa7a5cdc0abc23bcfe0e1d68ae27124e84a07923e4417062b314adf9d891e7471e4983d4bb0e8e04328b3dd126ae7a1cfd7f8d8bf07e009bde19aec7bd050ee287349feeda1c89faaecbe2b6172b2b6410299fc4010fbdec600c3ec20be3230aecb4600a45ff7e4c6f2892e22a63ebf2a4c56cd12f3653aef23aa165414fb58076fb6b71d88a3358ad2f9a8ead758971e8ec0b4ef6b96049443a6c991e1b085fc91c7d62b00c2555217c15032458ea3596738a2324d49c5d9358d8797fe324bda3b1f5489ffb004196db83fccbefa17d9f2cabccaef5aa5df3a27c98f11c33152d18b6025354c6300cdc16de0cb490d50e02a8912919aeb44023689d56651207d79b76504b4f960e75e6301e68760df803208a737b31f8d910e406d9bee8c87bb327d8a52f308522d120d20f0d13bd3b923f53bec2987fbd102e54c891f173b015dde9c3f7f3a09b75c01566311f2c8a43db04582d42b54502342a514d84318deaad78fb5561df7ac23ab5c95af459520e46dcce81faf2e845019357c723691c81bf8d4a083e5c7d9ad15b792a3ff68ea135f47ebe4b8f6606ed2f4f1046e2964a9f45bd5d1fd832472e23138a2d7a918123c75072c8e5f5f0e8d4da2bfb0bed1e391355fa814f37d7c06098044ef88592795a2a576e1bc30cb9b83bae73468b342d4954a5686aec050d751021d756061c2331fb2fc134dfb9211b076009386783accd3e7f6c43865737f56f5285b4359e9971e3b1acbeaed84710254cefbc4e5506d86ac9b9c65017ffa9a21f5f15532a49daa7515936214e755919610df5fde3ce43bbf27ad2536cad77e61962c5eba095c8a5496828b2f98a67452403f9048f5cd854f79b3a16d905d99929183004d0e915c1188fae548ef3fc79faa8cd13dd0742e8833e67cb53f729032fdb940080dd7cab594be692809bd43bb7489f78524cbaa0a8bd2ebda9bdfb12e510661f6a64fd453094a3d3a272bdd7a8e770819d38d3a650672bf6a2fbeb06200a5f661a3b7e4c45adbd2072bc3104f542cb64b7e268ad59060431810dc25fb10b6117f94bba926239aefe14e518a1886631667e2da90d5ec8a936683e67651779b156bba47615b3bf6c4041e17ab1817a43086a43e3f1d11bd8b247b0c0356951129f848cfe3f790c33401cd1a10c865d27c88ae9ba80868f9ba9a08ed854bd6e726f25fcda9d1eabc8e0696d42fc082c034055a30a8623ddbce9f6cda5c47d5044714f251319d5cbd34cfc5198f27412686610055db7f05b0a10b27e6566f85ac6d74caf0cd5f10b4a5ea9e30c35ace64263b2237004b3eacef4237aff6c1b8f1e33cb9677b9da820809d6c014f0d939d4539078edee152165f875b638e386ac500898374b0e44f4905430a3bab5ab2c0539b119f13133c09bb80a7f9ad08a99c597a2cefad92fa342fbd6fbbb56eadf5cd917f8c45cce55c1293890e0c31e041df515a7b4c2ddfc0668db133f9dd8cec5ddf66423ab98703d17603a90b79b1ea6aac767537a54</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-wave">      <input class="hbe hbe-input-field hbe-input-field-wave" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-wave" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-wave">您好, 这里需要密码.</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-wave" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
            <tag> 工作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python Tornado</title>
      <link href="/2021/12/16/python/Python%20Tornado/"/>
      <url>/2021/12/16/python/Python%20Tornado/</url>
      
        <content type="html"><![CDATA[<h1 id="Python-Tornado"><a href="#Python-Tornado" class="headerlink" title="Python Tornado"></a>Python Tornado</h1><p><a href="https://www.osgeo.cn/tornado/">Tornado Web Server - Tornado 6.1b1 文档</a><br><a href="https://iworkh.gitee.io/blog/2020/06/08/python_tornado_info/">👍Tornado入门这一篇足以 | iworkh blog</a><br>中文文档</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python中实现PHP的魔术方法call和callStatic</title>
      <link href="/2021/12/16/python/Python%E4%B8%AD%E5%AE%9E%E7%8E%B0PHP%E7%9A%84%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95call%E5%92%8CcallStatic/"/>
      <url>/2021/12/16/python/Python%E4%B8%AD%E5%AE%9E%E7%8E%B0PHP%E7%9A%84%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95call%E5%92%8CcallStatic/</url>
      
        <content type="html"><![CDATA[<h1 id="Python中实现PHP的魔术方法call和callStatic"><a href="#Python中实现PHP的魔术方法call和callStatic" class="headerlink" title="Python中实现PHP的魔术方法call和callStatic"></a>Python中实现PHP的魔术方法call和callStatic</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicMeta</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    调用MagicCall不存在的方法时，会调用其元类的getattr方法</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, method_name</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            <span class="built_in">getattr</span>(self, <span class="string">&#x27;_callStaticMethod&#x27;</span>)(method_name, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicCall</span>():</span></span><br><span class="line">    <span class="string">&quot;重定义类的元类&quot;</span></span><br><span class="line">    __metaclass__ = MagicMeta</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, method_name</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            self._callMethod(method_name, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_callStaticMethod</span>(<span class="params">method_name, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        调用不存在的静态方法时执行的函数</span></span><br><span class="line"><span class="string">        :param method_name: 方法名</span></span><br><span class="line"><span class="string">        :param args:   方法参数</span></span><br><span class="line"><span class="string">        :param kwargs: 方法参数</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_callMethod</span>(<span class="params">self, method_name, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        调用不存在的方法时执行的函数</span></span><br><span class="line"><span class="string">        :param method_name: 方法名</span></span><br><span class="line"><span class="string">        :param args:   方法参数</span></span><br><span class="line"><span class="string">        :param kwargs: 方法参数</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>(<span class="params">MagicCall</span>):</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_callStaticMethod</span>(<span class="params">method_name, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(method_name, args, kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_callMethod</span>(<span class="params">self, method_name, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(method_name, args, kwargs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span> :</span><br><span class="line">    ins = MyClass()</span><br><span class="line">    ins.hello(<span class="string">&#x27;xx&#x27;</span>, <span class="string">&#x27;pp&#x27;</span>)</span><br><span class="line">    MyClass.hello(<span class="string">&#x27;xxx&#x27;</span>, <span class="string">&#x27;ppp&#x27;</span>, xname=<span class="string">&#x27;linxianlong&#x27;</span>)</span><br><span class="line">    MethodProxy.hello()</span><br></pre></td></tr></table></figure><p><a href="http://longlog.me/2017/07/24/python-call-callStatic/">Python中实现PHP的魔术方法call和callStatic</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python celery</title>
      <link href="/2021/12/16/python/python%20celery/"/>
      <url>/2021/12/16/python/python%20celery/</url>
      
        <content type="html"><![CDATA[<h1 id="python-celery"><a href="#python-celery" class="headerlink" title="python celery"></a>python celery</h1><p>中文文档</p><p><a href="https://www.celerycn.io/yong-hu-zhi-nan/tiao-yong-ren-wu-calling-tasks">调用任务：Calling Tasks</a></p><p>英文文档</p><p><a href="https://docs.celeryproject.org/en/stable/index.html">Celery - Distributed Task Queue - Celery 5.1.2 documentation</a></p><p>celery exchange 配置</p><p><a href="https://www.cnblogs.com/ajianbeyourself/p/4950758.html">使用celery之深入celery配置（转）</a></p><p><strong>MySQL在 celery 任务期间不断失去连接</strong></p><p><a href="https://www.coder.work/article/4643613">python - MySQL在 celery 任务期间不断失去连接</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python wechatpy</title>
      <link href="/2021/12/16/python/python%20wechatpy/"/>
      <url>/2021/12/16/python/python%20wechatpy/</url>
      
        <content type="html"><![CDATA[<h1 id="python-wechatpy"><a href="#python-wechatpy" class="headerlink" title="python wechatpy"></a>python wechatpy</h1>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python 单例模式</title>
      <link href="/2021/12/16/python/python%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2021/12/16/python/python%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="python-单例模式"><a href="#python-单例模式" class="headerlink" title="python 单例模式"></a>python 单例模式</h1><p>#学习</p><p><strong>使用 new 关键字实现单例模式</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">hasattr</span>(cls,<span class="string">&quot;_instance&quot;</span>):</span><br><span class="line">            cls._instance = <span class="built_in">super</span>(Singleton, cls).__new__(cls, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._instance</span><br><span class="line"></span><br><span class="line">s1 = Singleton()</span><br><span class="line">s2 = Singleton()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> s1 <span class="keyword">is</span> s2</span><br></pre></td></tr></table></figure><p><strong>使用 metaclass 实现单例模式</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;__init__&quot;</span></span><br><span class="line">        self.__instance = <span class="literal">None</span></span><br><span class="line">        <span class="built_in">super</span>(Singleton,self).__init__(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;__call__&quot;</span></span><br><span class="line">        <span class="keyword">if</span> self.__instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            self.__instance = <span class="built_in">super</span>(Singleton,self).__call__(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> self.__instance</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    __metaclass__ = Singleton [[在代码执行到这里的时候，元类中的__new__方法和__init__方法其实已经被执行了，而不是在Foo]]实例化的时候执行。且仅会执行一次。</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    _instances = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">cls, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> cls._instances:</span><br><span class="line">            cls._instances[cls] = <span class="built_in">super</span>(Singleton, cls).__call__(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._instances[cls]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cls4</span>(<span class="params">metaclass=Singleton</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">cls1 = Cls4()</span><br><span class="line">cls2 = Cls4()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(cls1) == <span class="built_in">id</span>(cls2))</span><br></pre></td></tr></table></figure><p><strong>使用类装饰器实现单例</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, cls</span>):</span></span><br><span class="line">        self._cls = cls</span><br><span class="line">        self._instance = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self._cls <span class="keyword">not</span> <span class="keyword">in</span> self._instance:</span><br><span class="line">            self._instance[self._cls] = self._cls()</span><br><span class="line">        <span class="keyword">return</span> self._instance[self._cls]</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cls2</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">cls1 = Cls2()</span><br><span class="line">cls2 = Cls2()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(cls1) == <span class="built_in">id</span>(cls2))</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/tkqasn/p/6524879.html">苍松</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SFTP</title>
      <link href="/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/SFTP/"/>
      <url>/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/SFTP/</url>
      
        <content type="html"><![CDATA[<h1 id="SFTP"><a href="#SFTP" class="headerlink" title="SFTP"></a>SFTP</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;hd011&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;remotePath&quot;</span>: <span class="string">&quot;/data/spark/yechanggui/temp/&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;host&quot;</span>: <span class="string">&quot;jumper-huabei2-vpc.datagrand.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;yechanggui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;port&quot;</span>: <span class="number">58422</span>,</span><br><span class="line">    <span class="attr">&quot;privateKeyPath&quot;</span>: <span class="string">&quot;/Users/hc/.ssh/id_rsa&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hop&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;host&quot;</span>: <span class="string">&quot;172.17.132.120&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;spark&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;privateKeyPath&quot;</span>: <span class="string">&quot;/Users/hc/.ssh/id_rsa&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git</title>
      <link href="/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/git/"/>
      <url>/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/git/</url>
      
        <content type="html"><![CDATA[<h1 id="git"><a href="#git" class="headerlink" title="git"></a>git</h1><h2 id="GIT-添加-ssh"><a href="#GIT-添加-ssh" class="headerlink" title="GIT 添加 ssh"></a>GIT 添加 ssh</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh<span class="operator">-</span>agent bash</span><br><span class="line">ssh<span class="operator">-</span><span class="keyword">add</span> <span class="operator">~</span><span class="operator">/</span>.ssh<span class="operator">/</span>yecg</span><br></pre></td></tr></table></figure><h1 id="Git-加速"><a href="#Git-加速" class="headerlink" title="Git 加速"></a>Git 加速</h1><p><a href="https://qu.js.cn/how-to-speed-github/">国内加速Github的几种方案</a></p><h3 id="centos-升级git"><a href="#centos-升级git" class="headerlink" title="centos 升级git"></a>centos 升级git</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 添加源</span><br><span class="line">[root@CentOS ~]<span class="comment"># yum -y install https://packages.endpoint.com/rhel/7/os/x86_64/endpoint-repo-1.9-1.x86_64.rpm</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>. 安装 Git <span class="number">2</span>.x</span><br><span class="line">[root@CentOS ~]<span class="comment"># yum -y install git</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>. 验证</span><br><span class="line">[root@CentOS ~]<span class="comment"># git --version</span></span><br><span class="line">git version <span class="number">2.30</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nfs</title>
      <link href="/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/nfs/"/>
      <url>/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/nfs/</url>
      
        <content type="html"><![CDATA[<h1 id="nfs"><a href="#nfs" class="headerlink" title="nfs"></a>nfs</h1><h3 id="nfs-服务安装"><a href="#nfs-服务安装" class="headerlink" title="nfs 服务安装"></a>nfs 服务安装</h3><h3 id="服务端安装"><a href="#服务端安装" class="headerlink" title="服务端安装"></a>服务端安装</h3><ol><li>安装软件包</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y nfs-utils rpcbind</span><br></pre></td></tr></table></figure><ol start="2"><li>修改 /etc/exports</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/nfs_data/k8s-data <span class="number">172.17</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>(rw,no_root_squash,no_all_squash,sync)</span><br><span class="line"></span><br><span class="line">参数：-a 全部挂载或卸载 /etc/exports中的内容</span><br><span class="line"></span><br><span class="line">-r 重新读取/etc/exports 中的信息 ，并同步更新/etc/exports、/var/lib/nfs/xtab</span><br><span class="line"></span><br><span class="line">-u 卸载单一目录（和-a一起使用为卸载所有/etc/exports文件中的目录）</span><br><span class="line"></span><br><span class="line">-v 在export的时候，将详细的信息输出到屏幕上。</span><br></pre></td></tr></table></figure><ol start="3"><li>配置生效</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exportfs -arv</span><br></pre></td></tr></table></figure><ol start="4"><li>服务启动</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 停止</span><br><span class="line">service rpcbind stop</span><br><span class="line">service nfs stop</span><br><span class="line">-- 启动</span><br><span class="line">service rpcbind start</span><br><span class="line">service nfs start</span><br><span class="line">--查看状态</span><br><span class="line">service rpcbind status</span><br><span class="line">service nfs status</span><br></pre></td></tr></table></figure><h2 id="客户端安装"><a href="#客户端安装" class="headerlink" title="客户端安装"></a>客户端安装</h2><ol><li>安装软件包</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y nfs-utils rpcbind</span><br></pre></td></tr></table></figure><ol start="2"><li>挂载</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t nfs <span class="number">192.25</span><span class="number">.105</span><span class="number">.186</span>:/home/sharedata/azkaban/ODS_HS08 /home/data_azkaban</span><br></pre></td></tr></table></figure><ol start="3"><li>取消挂载</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查看占用命令：fuser -mv /home/data_azkaban</span><br><span class="line"></span><br><span class="line">杀死占用命令：fuser -kv /home/data_azkaban</span><br><span class="line"></span><br><span class="line">取消挂载命令：umount -a</span><br></pre></td></tr></table></figure><p>4.查看服务端是否开启挂载</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">showmount -e <span class="number">20.0</span><span class="number">.0</span><span class="number">.15</span>  <span class="comment">//查看NFS共享目录</span></span><br></pre></td></tr></table></figure><h2 id="nfs-脚本"><a href="#nfs-脚本" class="headerlink" title="nfs 脚本"></a>nfs 脚本</h2><p><strong>server</strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">NFS_ALLOW_IP = &quot;192.168.0.0/24&quot; </span><br><span class="line">echo “close firewalld&quot; </span><br><span class="line">systemctl stop firewalld </span><br><span class="line">systemctl status firewalld </span><br><span class="line">systemctl disable firewalld </span><br><span class="line">   </span><br><span class="line">echo &quot;install tools&quot; </span><br><span class="line">yum install -y nfs-utils rpcbind vim lrzsz unzip </span><br><span class="line">   </span><br><span class="line">echo &quot;nfs status&quot; </span><br><span class="line">systemctl start rpcbind </span><br><span class="line">systemctl start nfs </span><br><span class="line">systemctl status nfs </span><br><span class="line">echo &quot;config nfs&quot; </span><br><span class="line">cat /etc/exports </span><br><span class="line">echo &quot;/datagrand/   $(NFS_ALLOW_IP)(rw,sync,no_root_squash,no_all_squash)&quot; &gt;&gt; /etc/exports </span><br><span class="line">systemctl restart rpcbind </span><br><span class="line">systemctl restart nfs </span><br><span class="line">systemctl enable rpcbind </span><br><span class="line">systemctl enable nfs </span><br><span class="line">showmount -e localhost</span><br></pre></td></tr></table></figure><p><strong>client</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SERVER_IP = &quot;192.168.100.1&quot;</span><br><span class="line">echo “close firewalld&quot;</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl status firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line"></span><br><span class="line">echo &quot;install tools&quot;</span><br><span class="line">yum install -y nfs-utils rpcbind vim lrzsz unzip</span><br><span class="line">systemctl restart rpcbind </span><br><span class="line">systemctl enable rpcbind</span><br><span class="line">mkdir -p /datagrand</span><br><span class="line">mount -t nfs $(SERVER_IP):/datagrand  /datagrand</span><br><span class="line">showmount -e $(SERVER_IP)</span><br><span class="line"></span><br><span class="line">echo &quot;config nfs auto mount&quot;</span><br><span class="line">cat /etc/fstab</span><br><span class="line">echo &quot;$(SERVER_IP)/datagrand/  /datagrand  nfs  defaults  0  0 &quot; &gt;&gt; /etc/fstab </span><br><span class="line">Systemctl daemon-reload</span><br><span class="line">mount</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode</title>
      <link href="/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/vscode/"/>
      <url>/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/vscode/</url>
      
        <content type="html"><![CDATA[<h1 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h1><h2 id="vscode-画流程图"><a href="#vscode-画流程图" class="headerlink" title="vscode 画流程图"></a>vscode 画流程图</h2><p><a href="https://shd101wyy.github.io/markdown-preview-enhanced/[[/zh-cn/diagrams]]">Markdown Preview Enhanced</a></p><p>markdown Preview Enhanced</p><p><a href="https://www.cnblogs.com/wanghaokun/p/12485152.html">markdown画流程图-mermaid工具 - 爱吃柠檬不加糖 - 博客园</a></p><p>mermaid语法</p><p><a href="https://www.imooc.com/wiki/markdownlesson/markdownflowchart.html">21 Markdown 流程图丨慕课网教程</a></p><p><a href="https://cloud.tencent.com/developer/article/1820557">markdown小技巧：mermaid绘图工具介绍</a></p><p><a href="https://mermaid-js.github.io/mermaid/[[/sequenceDiagram]]">mermaid - Markdownish syntax for generating flowcharts, sequence diagrams, class diagrams, gantt charts and git graphs.</a></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">```mermaid</span></span><br><span class="line"><span class="code">graph TB</span></span><br><span class="line"><span class="code">    imported_anno_tasks[找到该图谱下所有已经导入的标注文档] </span></span><br><span class="line"><span class="code">    imported_task_ids[ids]</span></span><br><span class="line"><span class="code">    subgraph clear_annot_tsk</span></span><br><span class="line"><span class="code">    imported_anno_tasks --&gt; imported_task_ids</span></span><br><span class="line"><span class="code">    end</span></span><br><span class="line"><span class="code">    </span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">  A[Christmas] --&gt;|Get money| B(Go shopping)</span><br><span class="line">  subgraph T [&quot;Test&quot;]</span><br><span class="line">    A</span><br><span class="line">    B</span><br><span class="line">  end</span><br><span class="line">  classDef Test fill:[[F84E68]],stroke:#333,color:white;</span><br><span class="line">  class A,T Test</span><br><span class="line">  classDef TestSub fill:green;</span><br><span class="line">  class T TestSub</span><br><span class="line">  linkStyle 0 color:orange, stroke: orange;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">flowchart TB</span><br><span class="line">    c1--&gt;a2</span><br><span class="line">    subgraph one</span><br><span class="line">    a1--&gt;a2</span><br><span class="line">    end</span><br><span class="line">    subgraph two</span><br><span class="line">    b1--&gt;b2</span><br><span class="line">    end</span><br><span class="line">    subgraph three</span><br><span class="line">    c1--&gt;c2</span><br><span class="line">    end</span><br><span class="line">    one --&gt; two</span><br><span class="line">    three --&gt; two</span><br><span class="line">    two --&gt; c2</span><br></pre></td></tr></table></figure><p>```</p>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>太极</title>
      <link href="/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E5%A4%AA%E6%9E%81/"/>
      <url>/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E5%A4%AA%E6%9E%81/</url>
      
        <content type="html"><![CDATA[<h1 id="太极"><a href="#太极" class="headerlink" title="太极"></a>太极</h1><p>#学习 </p><p>太极问题：</p><ol><li>在其他软件不能分享到微信。</li></ol><p><a href="https://taichi.cool/zh/">太极</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>镜像脚本</title>
      <link href="/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E9%95%9C%E5%83%8F%E8%84%9A%E6%9C%AC/"/>
      <url>/2021/12/16/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E9%95%9C%E5%83%8F%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="镜像脚本"><a href="#镜像脚本" class="headerlink" title="镜像脚本"></a>镜像脚本</h1><h3 id="解析镜像"><a href="#解析镜像" class="headerlink" title="解析镜像"></a>解析镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cat ./deployment/*.yaml | grep image | grep -v <span class="string">&#x27;#&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>|grep -P <span class="string">&#x27;\G\S&#x27;</span>|sort|uniq &gt; nlp_platform.txt</span><br></pre></td></tr></table></figure><h3 id="对比镜像"><a href="#对比镜像" class="headerlink" title="对比镜像"></a>对比镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -v -f exist.txt nlp_platform.txt &gt; lost_nlp_platform.txt</span><br></pre></td></tr></table></figure><h3 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat lost_idps.txt | <span class="keyword">while</span> <span class="built_in">read</span> line</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    docker pull <span class="variable">$&#123;line&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">cat nlp_demo.txt |xargs -n1 docker pull</span><br></pre></td></tr></table></figure><h3 id="打包镜像"><a href="#打包镜像" class="headerlink" title="打包镜像"></a>打包镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">images_dir=images_idps_`date +<span class="string">&quot;%Y-%m-%d&quot;</span>`</span><br><span class="line">mkdir <span class="variable">$images_dir</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">save_image</span></span> () &#123;</span><br><span class="line">    <span class="built_in">pushd</span> <span class="variable">$images_dir</span></span><br><span class="line">    image=<span class="variable">$1</span></span><br><span class="line">    saved_file=`<span class="built_in">echo</span> <span class="variable">$&#123;image&#125;</span> | awk -F / <span class="string">&#x27;&#123;print $NF&#125;&#x27;</span> | sed <span class="string">&#x27;s/:/-/g&#x27;</span>`.tar</span><br><span class="line">    zipped_file=<span class="variable">$saved_file</span>.gz</span><br><span class="line">    <span class="keyword">if</span> [ ! -f <span class="string">&quot;<span class="variable">$zipped_file</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;saving <span class="variable">$image</span> ...&quot;</span></span><br><span class="line">      docker save <span class="variable">$image</span> &gt; <span class="variable">$&#123;saved_file&#125;</span></span><br><span class="line">      tar -czvf <span class="variable">$&#123;zipped_file&#125;</span> <span class="variable">$&#123;saved_file&#125;</span></span><br><span class="line">      rm <span class="variable">$&#123;saved_file&#125;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">popd</span></span><br><span class="line">&#125;</span><br><span class="line">cat lost_nlp_platform.txt | <span class="keyword">while</span> <span class="built_in">read</span> line</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    save_image <span class="variable">$&#123;line&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">docker save $(cat test.txt) &gt; yskg.tar &amp;&amp; gzip yskg.tar</span><br></pre></td></tr></table></figure><p>镜像tag修改</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&quot;s/host\/namespace/host\/namespace/g&quot;</span> `grep <span class="string">&#x27;iamge: &#x27;</span> -rl deployment/`</span><br></pre></td></tr></table></figure><p>删除特定行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sed -e <span class="string">&#x27;/resource/,+6d&#x27;</span> deployment/backendapi-deployment.yaml</span><br></pre></td></tr></table></figure><p>注释资源限制</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;/resources/,/memory/s/^/#/&#x27;</span> `grep <span class="string">&#x27;image: &#x27;</span> -rl deployment/`</span><br><span class="line">sed -i <span class="string">&#x27;/limits/,/memory/s/^/#/&#x27;</span> `grep <span class="string">&#x27;image: &#x27;</span> -rl deployment/`</span><br></pre></td></tr></table></figure><p>反注释资源限制</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;/resources/,/memory/s/#//&#x27;</span> auto_rule_extract_offline.yaml</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 奇技淫巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Arrango DB</title>
      <link href="/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/Arrango%20DB/Arrango%20DB/"/>
      <url>/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/Arrango%20DB/Arrango%20DB/</url>
      
        <content type="html"><![CDATA[<h1 id="Arrango-DB"><a href="#Arrango-DB" class="headerlink" title="Arrango DB"></a>Arrango DB</h1><hr><h1 id="Reference-List"><a href="#Reference-List" class="headerlink" title="Reference List"></a>Reference List</h1><hr><p><a href="https://github.com/threatify/arango-orm">threatify/arango-orm</a></p><p><em><strong>arango-orm</strong></em></p><p><a href="https://www.arangodb.com/docs/stable/getting-started-querying-the-database.html">Querying the Database | Getting Started | Manual | ArangoDB Documentation</a></p><p>arrango 文档</p><p><a href="https://python-driver-for-arangodb.readthedocs.io/en/master/index.html">Compatibility - python-arango 6.1.0 documentation</a></p><p><em><strong>python-arrango</strong></em></p>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> Arrango DB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elastcsearch 自定义评分</title>
      <link href="/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/Elasticsearch/Elastcsearch%20%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%84%E5%88%86/"/>
      <url>/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/Elasticsearch/Elastcsearch%20%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%84%E5%88%86/</url>
      
        <content type="html"><![CDATA[<h1 id="Elastcsearch-自定义评分"><a href="#Elastcsearch-自定义评分" class="headerlink" title="Elastcsearch 自定义评分"></a>Elastcsearch 自定义评分</h1><p>Created: March 2, 2021 4:59 PM</p><h2 id="Boosting-类型"><a href="#Boosting-类型" class="headerlink" title="Boosting 类型"></a>Boosting 类型</h2><p>boosting分为两种类型：</p><p>第一种：索引期间修改文档的相关性。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;title&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;boost&quot;</span>: <span class="number">2</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">**<span class="comment">// 索引期间修改相关性的弊端非常明显：修改boost值的唯一方式是重建索引，reindex数据，成本太高了！**</span></span><br></pre></td></tr></table></figure><p>   第二种：查询的时候修改文档的相关性。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;boosting&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;positive&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;term&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;text&quot;</span> : <span class="string">&quot;apple&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;negative&quot;</span> : &#123;</span><br><span class="line">                 <span class="attr">&quot;term&quot;</span> : &#123;</span><br><span class="line">                     <span class="attr">&quot;text&quot;</span> : <span class="string">&quot;pie tart fruit crumble tree&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;negative_boost&quot;</span> : <span class="number">0.5</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>boost取值：0 - 1 之间的值，如：0.2，代表降低评分；</p><p>boost取值：&gt; 1， 如：1.5，代表提升评分。</p><h2 id="Function-score-自定义评分"><a href="#Function-score-自定义评分" class="headerlink" title="Function_score 自定义评分"></a>Function_score 自定义评分</h2><h3 id="1-通过script-score进行评分"><a href="#1-通过script-score进行评分" class="headerlink" title="1. 通过script_score进行评分"></a>1. 通过script_score进行评分</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;function_score&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;广发01&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;script_score&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;script&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;lang&quot;</span>: <span class="string">&quot;painless&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;inline&quot;</span>: <span class="string">&quot;0.9* _score + 0.1* doc[&#x27;importance&#x27;].value&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-通过functions进行评分"><a href="#2-通过functions进行评分" class="headerlink" title="2. 通过functions进行评分"></a>2. 通过functions进行评分</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;function_score&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;query&quot;</span>: &#123; <span class="attr">&quot;match_all&quot;</span>: &#123;&#125; &#125;,</span><br><span class="line">          <span class="attr">&quot;boost&quot;</span>: <span class="string">&quot;5&quot;</span>, </span><br><span class="line">          <span class="attr">&quot;functions&quot;</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="attr">&quot;filter&quot;</span>: &#123; <span class="attr">&quot;match&quot;</span>: &#123; <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;bar&quot;</span> &#125; &#125;,</span><br><span class="line">                  <span class="attr">&quot;random_score&quot;</span>: &#123;&#125;, </span><br><span class="line">                  <span class="attr">&quot;weight&quot;</span>: <span class="number">23</span></span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="attr">&quot;filter&quot;</span>: &#123; <span class="attr">&quot;match&quot;</span>: &#123; <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;cat&quot;</span> &#125; &#125;,</span><br><span class="line">                  <span class="attr">&quot;weight&quot;</span>: <span class="number">42</span></span><br><span class="line">              &#125;</span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">&quot;max_boost&quot;</span>: <span class="number">42</span>,</span><br><span class="line">          <span class="attr">&quot;score_mode&quot;</span>: <span class="string">&quot;max&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;boost_mode&quot;</span>: <span class="string">&quot;multiply&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;min_score&quot;</span> : <span class="number">42</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://www.jianshu.com/p/7dd9a2dca65c">Elasticsearch 7.x 深入【7】文档打分</a></p><p><a href="http://doc.codingdict.com/elasticsearch/251/">Function Score 查询</a></p><p><a href="https://cloud.tencent.com/developer/article/1600163">实战 | Elasticsearch自定义评分的N种方法</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> Elasticsearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>myql 多对多级联删除</title>
      <link href="/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/myql%20%E5%A4%9A%E5%AF%B9%E5%A4%9A%E7%BA%A7%E8%81%94%E5%88%A0%E9%99%A4/"/>
      <url>/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/myql%20%E5%A4%9A%E5%AF%B9%E5%A4%9A%E7%BA%A7%E8%81%94%E5%88%A0%E9%99%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="myql-多对多级联删除"><a href="#myql-多对多级联删除" class="headerlink" title="myql 多对多级联删除"></a>myql 多对多级联删除</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">task <span class="operator">=</span> relationship(</span><br><span class="line">        <span class="string">&#x27;AnnoTaskEntity&#x27;</span>, secondary<span class="operator">=</span><span class="string">&#x27;anno_task_group&#x27;</span>,</span><br><span class="line">        backref<span class="operator">=</span>db.backref(<span class="string">&#x27;group&#x27;</span>,  lazy<span class="operator">=</span><span class="string">&#x27;dynamic&#x27;</span>), </span><br><span class="line">        lazy<span class="operator">=</span><span class="string">&#x27;dynamic&#x27;</span>,</span><br><span class="line">        cascade<span class="operator">=</span><span class="string">&#x27;all, delete-orphan&#x27;</span>,</span><br><span class="line">        single_parent<span class="operator">=</span><span class="literal">True</span></span><br><span class="line">    #     passive_deletes<span class="operator">=</span><span class="literal">True</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure><h3 id="lazy-字段解释"><a href="#lazy-字段解释" class="headerlink" title="lazy 字段解释"></a>lazy 字段解释</h3><p>/</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://docs.sqlalchemy.org/en/14/orm/cascades.html#using-foreign-key-on-delete-with-many-to-many-relationships">SQLAlchemy 1.4 Documentation</a></p><p><a href="https://blog.csdn.net/gymaisyl/article/details/88556478">sqlalchemy中多对多关系级联删除的问题_gymaisyl的博客-CSDN博客</a></p><p><a href="https://www.osgeo.cn/sqlalchemy/orm/session_basics.html#deleting">SQLAlchemy 1.4 Documentation</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql</title>
      <link href="/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql/"/>
      <url>/2021/12/16/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql/</url>
      
        <content type="html"><![CDATA[<h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h1><h2 id="更新datetime-TO-timestamp"><a href="#更新datetime-TO-timestamp" class="headerlink" title="更新datetime  TO timestamp"></a>更新datetime  TO timestamp</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE data_grand_tb_event</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> ( <span class="keyword">SELECT</span> log_id, unix_timestamp(log_data_time) <span class="keyword">as</span> <span class="type">time</span> <span class="keyword">FROM</span> data_grand_tb_event ) c <span class="keyword">ON</span> data_grand_tb_event.log_id <span class="operator">=</span> c.log_id</span><br><span class="line"><span class="keyword">SET</span> data_grand_tb_event.time_stamp <span class="operator">=</span> c.time</span><br></pre></td></tr></table></figure><p><a href="https://www.osgeo.cn/sqlalchemy/orm/loading_columns.html#deferred-column-loading">SQLAlchemy 1.4 Documentation</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
